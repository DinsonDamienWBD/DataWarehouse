<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net10.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
    <AllowUnsafeBlocks>true</AllowUnsafeBlocks>
    <RootNamespace>DataWarehouse.Plugins.FuseDriver</RootNamespace>
    <AssemblyName>DataWarehouse.Plugins.FuseDriver</AssemblyName>
    <Description>DataWarehouse FUSE Filesystem Driver Plugin - Cross-platform FUSE-based filesystem for Linux and macOS</Description>

    <!-- Runtime identifiers for cross-platform native interop -->
    <RuntimeIdentifiers>linux-x64;linux-arm64;osx-x64;osx-arm64</RuntimeIdentifiers>

    <!-- Enable native library loading -->
    <EnableDynamicLoading>true</EnableDynamicLoading>
  </PropertyGroup>

  <!-- Conditional compilation symbols for platform-specific code -->
  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('Linux'))">
    <DefineConstants>$(DefineConstants);LINUX</DefineConstants>
  </PropertyGroup>

  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('OSX'))">
    <DefineConstants>$(DefineConstants);MACOS</DefineConstants>
  </PropertyGroup>

  <PropertyGroup Condition="$([MSBuild]::IsOSPlatform('FreeBSD'))">
    <DefineConstants>$(DefineConstants);FREEBSD</DefineConstants>
  </PropertyGroup>

  <ItemGroup>
    <ProjectReference Include="..\..\DataWarehouse.SDK\DataWarehouse.SDK.csproj" />
  </ItemGroup>

  <!-- Native library references for different platforms -->
  <ItemGroup Condition="$([MSBuild]::IsOSPlatform('Linux'))">
    <!-- libfuse3 is typically installed via package manager -->
    <NativeLibrary Include="libfuse3.so.3" />
  </ItemGroup>

  <ItemGroup Condition="$([MSBuild]::IsOSPlatform('OSX'))">
    <!-- macFUSE library path -->
    <NativeLibrary Include="libfuse.dylib" />
  </ItemGroup>

</Project>
