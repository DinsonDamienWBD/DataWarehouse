---
phase: 27-plugin-migration-decoupling
plan: 03
type: execute
wave: 2
depends_on: ["27-01"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateCompliance/UltimateCompliancePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateKeyManagement/UltimateKeyManagementPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataProtection/UltimateDataProtectionPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/UltimateInterfacePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateConnector/UltimateConnectorPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataGovernance/UltimateDataGovernancePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataCatalog/UltimateDataCatalogPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataQuality/UltimateDataQualityPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataLake/UltimateDataLakePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataMesh/UltimateDataMeshPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataPrivacy/UltimateDataPrivacyPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataManagement/UltimateDataManagementPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateCompute/UltimateComputePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateServerless/UltimateServerlessPlugin.cs
  - Plugins/DataWarehouse.Plugins.UniversalObservability/UniversalObservabilityPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateStreamingData/UltimateStreamingDataPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/UltimateIoTIntegrationPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateRTOSBridge/UltimateRTOSBridgePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataFormat/UltimateDataFormatPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDeployment/UltimateDeploymentPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateResilience/UltimateResiliencePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateSustainability/UltimateSustainabilityPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateMultiCloud/UltimateMultiCloudPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateWorkflow/UltimateWorkflowPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateEdgeComputing/UltimateEdgeComputingPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataIntegration/UltimateDataIntegrationPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateSDKPorts/UltimateSDKPortsPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateMicroservices/UltimateMicroservicesPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDocGen/UltimateDocGenPlugin.cs
  - Plugins/DataWarehouse.Plugins.AppPlatform/AppPlatformPlugin.cs
  - Plugins/DataWarehouse.Plugins.UniversalDashboards/UniversalDashboardsPlugin.cs
autonomous: true

must_haves:
  truths:
    - "All Feature-branch Ultimate plugins inherit from their respective Hierarchy domain bases"
    - "All plugins implement required abstract members (SecurityDomain, Protocol, RuntimeType, OrchestrationMode, InfrastructureDomain, PlatformDomain, etc.)"
    - "UltimateEdgeComputing migrated from bare PluginBase to OrchestrationPluginBase (Category E special case)"
    - "All 32 plugins build with zero new errors"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs"
      provides: "Security plugin on SecurityPluginBase"
      contains: "SecurityPluginBase"
    - path: "Plugins/DataWarehouse.Plugins.UltimateEdgeComputing/UltimateEdgeComputingPlugin.cs"
      provides: "EdgeComputing on OrchestrationPluginBase"
      contains: "OrchestrationPluginBase"
    - path: "Plugins/DataWarehouse.Plugins.UltimateCompute/UltimateComputePlugin.cs"
      provides: "Compute on ComputePluginBase"
      contains: "ComputePluginBase"
  key_links:
    - from: "Ultimate Feature plugins"
      to: "Hierarchy.Feature bases"
      via: "inheritance"
      pattern: ":\\s*(SecurityPluginBase|InterfacePluginBase|DataManagementPluginBase|ComputePluginBase|ObservabilityPluginBase|StreamingPluginBase|FormatPluginBase|InfrastructurePluginBase|OrchestrationPluginBase|PlatformPluginBase)"
---

<objective>
Migrate all 32 Feature-branch Ultimate plugins from obsolete IntelligenceAware* bases or bare IntelligenceAwarePluginBase to the correct Hierarchy Feature domain bases.

Purpose: This is the largest batch -- covering Security, Interface, DataManagement, Compute, Observability, Streaming, Format, Infrastructure, Orchestration, and Platform domain plugins. Most of these require only a base class swap plus implementing 1 abstract property (e.g., SecurityDomain, Protocol, RuntimeType). The Feature bases mostly have virtual-only methods, making migration low-risk.

Output: 32 plugin files updated with correct Hierarchy Feature base classes.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/27-plugin-migration-decoupling/27-RESEARCH.md
@.planning/phases/27-plugin-migration-decoupling/27-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Security, Interface, DataManagement, and Compute Ultimate plugins to Hierarchy Feature bases</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateCompliance/UltimateCompliancePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateKeyManagement/UltimateKeyManagementPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataProtection/UltimateDataProtectionPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/UltimateInterfacePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateConnector/UltimateConnectorPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataGovernance/UltimateDataGovernancePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataCatalog/UltimateDataCatalogPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataQuality/UltimateDataQualityPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataLake/UltimateDataLakePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataMesh/UltimateDataMeshPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataPrivacy/UltimateDataPrivacyPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataManagement/UltimateDataManagementPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateCompute/UltimateComputePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateServerless/UltimateServerlessPlugin.cs
  </files>
  <action>
    For each plugin, change the base class and add required abstract member implementations. Add `using DataWarehouse.SDK.Contracts.Hierarchy;` and remove obsolete using directives.

    **Security domain (4 plugins -> SecurityPluginBase):**
    - `UltimateAccessControlPlugin`: FROM `IntelligenceAwareAccessControlPluginBase` TO `SecurityPluginBase`
      - Add: `public override string SecurityDomain => "AccessControl";`
    - `UltimateCompliancePlugin`: FROM `IntelligenceAwareCompliancePluginBase` TO `SecurityPluginBase`
      - Add: `public override string SecurityDomain => "Compliance";`
      - NOTE: This plugin uses `using SdkStrategyBase = DataWarehouse.SDK.Contracts.StrategyBase;` alias from Phase 25b. Preserve this.
    - `UltimateKeyManagementPlugin`: FROM `IntelligenceAwareKeyManagementPluginBase` TO `SecurityPluginBase`
      - Add: `public override string SecurityDomain => "KeyManagement";`
    - `UltimateDataProtectionPlugin`: FROM `IntelligenceAwarePluginBase` TO `SecurityPluginBase`
      - Add: `public override string SecurityDomain => "DataProtection";`
      - NOTE: This plugin has `new` keyword on MessageBus/IsIntelligenceAvailable from Phase 25b. These may conflict with the Hierarchy chain. If SecurityPluginBase inherits IntelligenceAwarePluginBase which already provides these, the `new` might cause warnings/errors. Verify and adjust.

    **Interface domain (2 plugins -> InterfacePluginBase from Hierarchy):**
    - `UltimateInterfacePlugin`: FROM `IntelligenceAwareInterfacePluginBase` TO `InterfacePluginBase` (Hierarchy)
      - Add: `public override string Protocol => "MultiProtocol";` (or read existing protocol info)
      - CAREFUL: There's a name collision between old `InterfacePluginBase` (PluginBase.cs) and new `InterfacePluginBase` (Hierarchy). Use fully qualified `DataWarehouse.SDK.Contracts.Hierarchy.InterfacePluginBase` if the old namespace is also imported.
    - `UltimateConnectorPlugin`: FROM `IntelligenceAwareConnectorPluginBase` TO `InterfacePluginBase` (Hierarchy)
      - Add: `public override string Protocol => "Connector";`

    **DataManagement domain (7 plugins -> DataManagementPluginBase, virtual-only):**
    - `UltimateDataGovernancePlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - `UltimateDataCatalogPlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - `UltimateDataQualityPlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - `UltimateDataLakePlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - `UltimateDataMeshPlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - `UltimateDataPrivacyPlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - `UltimateDataManagementPlugin`: FROM `IntelligenceAwareDataManagementPluginBase` TO `DataManagementPluginBase`
    - DataManagementPluginBase has NO abstract methods (only virtual). Simple base class swap.

    **Compute domain (2 plugins -> ComputePluginBase):**
    - `UltimateComputePlugin`: FROM `IntelligenceAwarePluginBase` TO `ComputePluginBase`
      - Add: `public override string RuntimeType => "General";`
      - Add: `public override Task<Dictionary<string, object>> ExecuteWorkloadAsync(Dictionary<string, object> workload, CancellationToken ct = default)` -- map to existing compute execution method if present, or implement with the plugin's existing workload logic
    - `UltimateServerlessPlugin`: FROM `IntelligenceAwarePluginBase` TO `ComputePluginBase`
      - Add: `public override string RuntimeType => "Serverless";`
      - Add: `ExecuteWorkloadAsync` implementation

    Build each group after migration to catch errors early.
  </action>
  <verify>
    `dotnet build DataWarehouse.slnx` -- all 15 plugins compile with zero new errors.
    Grep each plugin file for the correct Hierarchy base class name.
  </verify>
  <done>15 Feature plugins (Security, Interface, DataManagement, Compute) migrated to correct Hierarchy Feature bases.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Observability, Streaming, Format, Infrastructure, Orchestration, Platform Ultimate plugins and remaining standalone Ultimate-level plugins</name>
  <files>
    Plugins/DataWarehouse.Plugins.UniversalObservability/UniversalObservabilityPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateStreamingData/UltimateStreamingDataPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/UltimateIoTIntegrationPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateRTOSBridge/UltimateRTOSBridgePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataFormat/UltimateDataFormatPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDeployment/UltimateDeploymentPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateResilience/UltimateResiliencePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateSustainability/UltimateSustainabilityPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateMultiCloud/UltimateMultiCloudPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateWorkflow/UltimateWorkflowPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateEdgeComputing/UltimateEdgeComputingPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataIntegration/UltimateDataIntegrationPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateSDKPorts/UltimateSDKPortsPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateMicroservices/UltimateMicroservicesPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDocGen/UltimateDocGenPlugin.cs
    Plugins/DataWarehouse.Plugins.AppPlatform/AppPlatformPlugin.cs
    Plugins/DataWarehouse.Plugins.UniversalDashboards/UniversalDashboardsPlugin.cs
  </files>
  <action>
    Migrate 17 remaining Feature-branch plugins. Add `using DataWarehouse.SDK.Contracts.Hierarchy;` and remove obsolete usings for each.

    **Observability (1 plugin -> ObservabilityPluginBase, virtual-only):**
    - `UniversalObservabilityPlugin`: FROM `IntelligenceAwarePluginBase` TO `ObservabilityPluginBase`
    - No new abstract methods required.

    **Streaming (3 plugins -> StreamingPluginBase):**
    - `UltimateStreamingDataPlugin`: FROM `IntelligenceAwarePluginBase` TO `StreamingPluginBase`
    - `UltimateIoTIntegrationPlugin`: FROM `IntelligenceAwarePluginBase` TO `StreamingPluginBase`
    - `UltimateRTOSBridgePlugin`: FROM `IntelligenceAwarePluginBase` TO `StreamingPluginBase`
    - StreamingPluginBase requires: `abstract Task PublishAsync(string topic, Stream data, CancellationToken ct)` and `abstract IAsyncEnumerable<Dictionary<string, object>> SubscribeAsync(string topic, CancellationToken ct)`
    - These plugins likely have publish/subscribe methods. Map to new signatures. If they use different pub/sub patterns, create bridge implementations.

    **Format (1 plugin -> FormatPluginBase, virtual-only):**
    - `UltimateDataFormatPlugin`: FROM `IntelligenceAwarePluginBase` TO `FormatPluginBase`
    - No new abstract methods required.

    **Infrastructure (4 plugins -> InfrastructurePluginBase):**
    - `UltimateDeploymentPlugin`: FROM `IntelligenceAwarePluginBase` TO `InfrastructurePluginBase`
      - Add: `public override string InfrastructureDomain => "Deployment";`
    - `UltimateResiliencePlugin`: FROM `IntelligenceAwarePluginBase` TO `InfrastructurePluginBase`
      - Add: `public override string InfrastructureDomain => "Resilience";`
    - `UltimateSustainabilityPlugin`: FROM `IntelligenceAwarePluginBase` TO `InfrastructurePluginBase`
      - Add: `public override string InfrastructureDomain => "Sustainability";`
    - `UltimateMultiCloudPlugin`: FROM `IntelligenceAwarePluginBase` TO `InfrastructurePluginBase`
      - Add: `public override string InfrastructureDomain => "MultiCloud";`

    **Orchestration (3 plugins -> OrchestrationPluginBase):**
    - `UltimateWorkflowPlugin`: FROM `IntelligenceAwarePluginBase` TO `OrchestrationPluginBase`
      - Add: `public override string OrchestrationMode => "Workflow";`
    - `UltimateEdgeComputingPlugin`: FROM bare `PluginBase` TO `OrchestrationPluginBase`
      - **CATEGORY E SPECIAL CASE**: Currently on bare PluginBase (skips IntelligenceAwarePluginBase entirely). This is a significant migration adding the full IntelligenceAware layer.
      - Add: `public override string OrchestrationMode => "EdgeComputing";`
      - This plugin had `new ShutdownAsync` from Phase 24. After moving to OrchestrationPluginBase (which has ShutdownAsync via PluginBase inheritance), verify if `new` is still needed or should be `override`.
      - Ensure the plugin has Id, Name, Version, Category properties (PluginBase requires these).
    - `UltimateDataIntegrationPlugin`: FROM `IntelligenceAwarePluginBase` TO `OrchestrationPluginBase`
      - Add: `public override string OrchestrationMode => "DataIntegration";`

    **Platform (3 plugins -> PlatformPluginBase):**
    - `UltimateSDKPortsPlugin`: FROM `IntelligenceAwarePluginBase` TO `PlatformPluginBase`
      - Add: `public override string PlatformDomain => "SDKPorts";`
    - `UltimateMicroservicesPlugin`: FROM `IntelligenceAwarePluginBase` TO `PlatformPluginBase`
      - Add: `public override string PlatformDomain => "Microservices";`
    - `UltimateDocGenPlugin`: FROM `IntelligenceAwarePluginBase` TO `PlatformPluginBase`
      - Add: `public override string PlatformDomain => "Documentation";`

    **Additional standalone Ultimate-level plugins (2):**
    - `AppPlatformPlugin`: FROM `IntelligenceAwarePluginBase` TO `PlatformPluginBase`
      - Add: `public override string PlatformDomain => "AppPlatform";`
    - `UniversalDashboardsPlugin`: FROM `IntelligenceAwarePluginBase` TO `InterfacePluginBase` (Hierarchy)
      - Add: `public override string Protocol => "Dashboard";`

    Build full solution after all migrations.
  </action>
  <verify>
    `dotnet build DataWarehouse.slnx` -- zero new errors beyond pre-existing.
    Grep across all 32 plugin files (Task 1 + Task 2) to confirm no references to `IntelligenceAwarePluginBase`, `IntelligenceAwareAccessControlPluginBase`, `IntelligenceAwareCompliancePluginBase`, `IntelligenceAwareKeyManagementPluginBase`, `IntelligenceAwareInterfacePluginBase`, `IntelligenceAwareConnectorPluginBase`, or `IntelligenceAwareDataManagementPluginBase` remain.
  </verify>
  <done>All 32 Feature-branch Ultimate plugins migrated to correct Hierarchy Feature bases. UltimateEdgeComputing special case resolved. All plugins compile.</done>
</task>

</tasks>

<verification>
- All 32 Feature-branch plugins use Hierarchy Feature bases
- Zero references to obsolete IntelligenceAware*PluginBase in any plugin file
- `dotnet build DataWarehouse.slnx` shows only pre-existing errors
- Each domain-specific abstract property (SecurityDomain, Protocol, RuntimeType, OrchestrationMode, InfrastructureDomain, PlatformDomain) is implemented in all concrete plugins
</verification>

<success_criteria>
1. All 4 Security plugins -> SecurityPluginBase with SecurityDomain property
2. All 2 Interface plugins + UniversalDashboards -> InterfacePluginBase with Protocol property
3. All 7 DataManagement plugins -> DataManagementPluginBase
4. All 2 Compute plugins -> ComputePluginBase with RuntimeType + ExecuteWorkloadAsync
5. UniversalObservability -> ObservabilityPluginBase
6. All 3 Streaming plugins -> StreamingPluginBase with PublishAsync + SubscribeAsync
7. UltimateDataFormat -> FormatPluginBase
8. All 4 Infrastructure plugins -> InfrastructurePluginBase with InfrastructureDomain
9. All 3 Orchestration plugins -> OrchestrationPluginBase with OrchestrationMode (including EdgeComputing special case)
10. All 4 Platform plugins (including AppPlatform) -> PlatformPluginBase with PlatformDomain
11. Full solution builds with zero new errors
</success_criteria>

<output>
After completion, create `.planning/phases/27-plugin-migration-decoupling/27-03-SUMMARY.md`
</output>
