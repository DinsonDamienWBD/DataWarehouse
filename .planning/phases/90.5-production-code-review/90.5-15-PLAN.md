---
phase: 90.5-production-code-review
plan: 15
type: manual
wave: 3
depends_on: ["90.5-04"]
files_modified: [Plugins/DataWarehouse.Plugins.UltimateStorage/]
autonomous: false

must_haves:
  truths:
    - "All 5 FutureHardware strategies have real implementations or are properly guarded"
    - "All 277 Task.CompletedTask no-ops are replaced with real storage operations"
    - "Every storage strategy performs real I/O operations"
    - "Wiring document explains storage backend selection, I/O path, and caching integration"
  artifacts:
    - path: ".planning/phases/90.5-production-code-review/wiring/15-storage-wiring.md"
      provides: "Complete wiring documentation for UltimateStorage"
  key_links:
    - from: "Plugins/DataWarehouse.Plugins.UltimateStorage/"
      to: "DataWarehouse.SDK/VirtualDiskEngine/"
      via: "Block device implementations for various storage backends"
---

<objective>
Production Code Review and Gap Closure for UltimateStorage plugin.

Purpose: UltimateStorage is the largest plugin by gap count. 5 FutureHardware throws + 277 Task.CompletedTask = the most no-ops of any plugin. Storage is the core data path -- every no-op means data loss.

Output: Zero-gap UltimateStorage with comprehensive wiring documentation.
</objective>

<context>
@.planning/PROJECT.md
@.planning/PLUGIN-CATALOG.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Systematic Scan of UltimateStorage</name>
  <files>Plugins/DataWarehouse.Plugins.UltimateStorage/</files>
  <action>

    **MANDATORY PER-FILE REPORTING RULE:**
    Every single .cs file in the project directory MUST be individually listed in the findings report. No exceptions, no summarization across files. For each file report:
    - Full file path and total line count
    - Every finding (stub, no-op, gap, fake payload, TODO) with exact line number(s) and code snippet
    - If the file has zero issues, explicitly list it as: "filename.cs (N lines) â€” CLEAN, no issues"
    
    Do NOT skip any file. Do NOT group files together. Do NOT say "similar pattern in X files".
    Go through every line of code in every file. We are closing all gaps once and for all.
    Perform exhaustive scan for:
    1. **5 FutureHardware strategies**: Locate and assess (DNA storage, photonic, quantum, etc.)
    2. **277 Task.CompletedTask no-ops**: Locate ALL, group by subsystem:
       - Block storage operations
       - File storage operations
       - Object storage operations
       - Cache operations
       - Tiering operations
       - Health/monitoring operations
    3. Additional throws, fake payloads, TODO comments
    4. Storage strategies that don't actually read/write data

    For FutureHardware: classify as GUARD (hardware doesn't exist yet) vs IMPLEMENT (can simulate with standard I/O).

    Present findings grouped by subsystem to user. This will be a large findings list.
  </action>
  <verify>User reviews findings and approves fix plan (may prioritize subsystems)</verify>
  <done>Complete inventory of 282+ gaps presented to user by subsystem</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Implement Storage Fixes</name>
  <files>Plugins/DataWarehouse.Plugins.UltimateStorage/</files>
  <action>
    Implement all agreed fixes (this is the largest remediation):

    1. **FutureHardware**: Per user decision -- implement generic I/O adapter or document as guards
    2. **Block storage no-ops**: Implement real block read/write/allocate/free
    3. **File storage no-ops**: Implement real file operations
    4. **Object storage no-ops**: Implement real object CRUD
    5. **Cache no-ops**: Implement real cache get/set/evict
    6. **Tiering no-ops**: Implement real tier migration
    7. **Health/monitoring**: Implement real metrics collection

    Each storage strategy must perform real I/O. No silent data loss paths.

    Rescan and build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateStorage/`

    NOTE: This is a large plugin. May need multiple scan/fix cycles.
  </action>
  <verify>Rescan shows zero no-ops remaining (except approved guards), build succeeds</verify>
  <done>All 277+ no-ops replaced with real logic, plugin builds clean</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Write Wiring Document</name>
  <files>.planning/phases/90.5-production-code-review/wiring/15-storage-wiring.md</files>
  <action>
    Document: All storage backends, I/O path from API to physical storage, block allocation, caching layers, tiering pipeline, health monitoring, VDE integration, storage driver model.
  </action>
  <verify>User reviews wiring document</verify>
  <done>Wiring document complete, approved by user</done>
</task>

</tasks>

<verification>
- Zero Task.CompletedTask no-ops remaining (except approved FutureHardware guards)
- All storage operations perform real I/O
- Plugin builds clean
- Wiring document complete
</verification>

<success_criteria>
UltimateStorage is 100% production-ready. All 277 no-ops replaced, FutureHardware resolved. Wiring document complete.
</success_criteria>

<output>
After completion, create `.planning/phases/90.5-production-code-review/90.5-15-SUMMARY.md`
</output>
