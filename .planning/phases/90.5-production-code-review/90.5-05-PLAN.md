---
phase: 90.5-production-code-review
plan: 05
type: manual
wave: 3
depends_on: ["90.5-04"]
files_modified: [Plugins/DataWarehouse.Plugins.UltimateAccessControl/]
autonomous: false

must_haves:
  truths:
    - "All access control strategies have real evaluation logic"
    - "RBAC, ABAC, and ACL strategies enforce real permission checks"
    - "No stub or no-op code paths remain"
    - "Wiring document explains how access control integrates with kernel and other plugins"
  artifacts:
    - path: ".planning/phases/90.5-production-code-review/wiring/05-access-control-wiring.md"
      provides: "Complete wiring documentation for UltimateAccessControl"
  key_links:
    - from: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/"
      to: "DataWarehouse.SDK/Contracts/"
      via: "Access control contract implementations"
---

<objective>
Production Code Review and Gap Closure for UltimateAccessControl plugin.

Purpose: Access control is a security-critical plugin. Any stub here means unenforced permissions or authentication bypass.

Output: Zero-gap UltimateAccessControl with comprehensive wiring documentation.
</objective>

<context>
@.planning/PROJECT.md
@.planning/PLUGIN-CATALOG.md
@.planning/phases/90.5-production-code-review/90.5-04-SUMMARY.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Systematic Scan of UltimateAccessControl</name>
  <files>Plugins/DataWarehouse.Plugins.UltimateAccessControl/</files>
  <action>

    **MANDATORY PER-FILE REPORTING RULE:**
    Every single .cs file in the project directory MUST be individually listed in the findings report. No exceptions, no summarization across files. For each file report:
    - Full file path and total line count
    - Every finding (stub, no-op, gap, fake payload, TODO) with exact line number(s) and code snippet
    - If the file has zero issues, explicitly list it as: "filename.cs (N lines) â€” CLEAN, no issues"
    
    Do NOT skip any file. Do NOT group files together. Do NOT say "similar pattern in X files".
    Go through every line of code in every file. We are closing all gaps once and for all.
    Perform exhaustive scan of ALL files for:
    1. NotImplementedException / NotSupportedException throws
    2. Task.CompletedTask / Task.FromResult no-ops
    3. Fake payloads, hardcoded credentials, placeholder tokens
    4. TODO/FIXME/HACK comments
    5. Strategies that always return true/false (bypass logic)
    6. Authentication methods that skip verification

    Present findings table with severity (CRITICAL for security bypass paths).
  </action>
  <verify>User reviews findings and approves fix plan</verify>
  <done>Complete inventory of all gaps presented to user</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Implement Fixes</name>
  <files>Plugins/DataWarehouse.Plugins.UltimateAccessControl/</files>
  <action>
    Implement all agreed fixes. Security-critical plugin requires:
    1. Every permission check must actually evaluate against policy
    2. Every authentication strategy must verify credentials
    3. No fallback to "allow all" on error
    4. Proper audit logging for access decisions
    5. Token validation must check expiry, signature, and claims

    Rescan after fixes. Build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateAccessControl/`
  </action>
  <verify>Rescan clean, build succeeds, user confirms</verify>
  <done>All gaps closed, plugin builds clean</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Write Wiring Document</name>
  <files>.planning/phases/90.5-production-code-review/wiring/05-access-control-wiring.md</files>
  <action>
    Document: Strategy registry, permission evaluation flow, authentication chain, integration with kernel message bus, how other plugins request access checks, audit trail flow.
  </action>
  <verify>User reviews wiring document</verify>
  <done>Wiring document complete, approved by user</done>
</task>

</tasks>

<verification>
- Zero stubs/no-ops remaining
- No security bypass paths
- Plugin builds clean
- Wiring document complete
</verification>

<success_criteria>
UltimateAccessControl is 100% production-ready with real security enforcement. Wiring document complete.
</success_criteria>

<output>
After completion, create `.planning/phases/90.5-production-code-review/90.5-05-SUMMARY.md`
</output>
