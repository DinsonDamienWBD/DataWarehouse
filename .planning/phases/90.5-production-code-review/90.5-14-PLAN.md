---
phase: 90.5-production-code-review
plan: 14
type: manual
wave: 3
depends_on: ["90.5-04"]
files_modified: [Plugins/DataWarehouse.Plugins.UltimateReplication/]
autonomous: false

must_haves:
  truths:
    - "All ~2 throws are replaced with real replication logic"
    - "All 47 Task.CompletedTask no-ops are replaced with real operations"
    - "Replication strategies actually replicate data between nodes"
    - "Wiring document explains replication topology, conflict resolution, and consistency model"
  artifacts:
    - path: ".planning/phases/90.5-production-code-review/wiring/14-replication-wiring.md"
      provides: "Complete wiring documentation for UltimateReplication"
  key_links:
    - from: "Plugins/DataWarehouse.Plugins.UltimateReplication/"
      to: "DataWarehouse.SDK/Infrastructure/Distributed/"
      via: "Distributed coordination primitives"
---

<objective>
Production Code Review and Gap Closure for UltimateReplication plugin.

Purpose: Replication provides data durability and availability. ~2 throws + 47 Task.CompletedTask mean replication silently skips. Data appears replicated but isn't.

Output: Zero-gap UltimateReplication with comprehensive wiring documentation.
</objective>

<context>
@.planning/PROJECT.md
@.planning/PLUGIN-CATALOG.md
</context>

<tasks>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 1: Systematic Scan of UltimateReplication</name>
  <files>Plugins/DataWarehouse.Plugins.UltimateReplication/</files>
  <action>

    **MANDATORY PER-FILE REPORTING RULE:**
    Every single .cs file in the project directory MUST be individually listed in the findings report. No exceptions, no summarization across files. For each file report:
    - Full file path and total line count
    - Every finding (stub, no-op, gap, fake payload, TODO) with exact line number(s) and code snippet
    - If the file has zero issues, explicitly list it as: "filename.cs (N lines) â€” CLEAN, no issues"
    
    Do NOT skip any file. Do NOT group files together. Do NOT say "similar pattern in X files".
    Go through every line of code in every file. We are closing all gaps once and for all.
    Perform exhaustive scan for:
    1. All ~2 throws
    2. All 47 Task.CompletedTask no-ops
    3. Replication strategies that don't actually send/receive data
    4. Conflict resolution that always picks one side without merging
    5. TODO/FIXME comments

    Group by replication type: synchronous, asynchronous, chain, multi-master, snapshot.

    Present findings to user.
  </action>
  <verify>User reviews findings and approves fix plan</verify>
  <done>Complete inventory presented to user</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 2: Implement Replication Fixes</name>
  <files>Plugins/DataWarehouse.Plugins.UltimateReplication/</files>
  <action>
    Implement all fixes:
    1. Each replication strategy must actually transfer data to replicas
    2. Conflict resolution must use real merge logic (CRDT, vector clocks, or configurable)
    3. Replication lag monitoring must track real metrics
    4. Snapshot replication must capture consistent point-in-time state
    5. All 47 Task.CompletedTask: replace with real async replication operations

    Rescan and build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateReplication/`
  </action>
  <verify>Rescan clean, build succeeds, user confirms</verify>
  <done>All 49 gaps closed, plugin builds clean</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <name>Task 3: Write Wiring Document</name>
  <files>.planning/phases/90.5-production-code-review/wiring/14-replication-wiring.md</files>
  <action>
    Document: Replication topologies, sync vs async modes, conflict resolution strategies, consistency guarantees, replication lag monitoring, snapshot mechanism, failover procedures.
  </action>
  <verify>User reviews wiring document</verify>
  <done>Wiring document complete, approved by user</done>
</task>

</tasks>

<verification>
- Zero throws/no-ops remaining
- Plugin builds clean
- Wiring document complete
</verification>

<success_criteria>
UltimateReplication is 100% production-ready. All replication strategies actually replicate. Wiring document complete.
</success_criteria>

<output>
After completion, create `.planning/phases/90.5-production-code-review/90.5-14-SUMMARY.md`
</output>
