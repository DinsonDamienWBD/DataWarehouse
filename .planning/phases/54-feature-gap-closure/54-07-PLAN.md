---
phase: 54-feature-gap-closure
plan: 07
type: execute
wave: 2
depends_on: [54-03]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateReplication/Strategies/**
  - Plugins/DataWarehouse.Plugins.UltimateConsensus/Algorithms/**
  - Plugins/DataWarehouse.Plugins.UltimateEdgeComputing/Strategies/**
  - Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/Strategies/**
  - Plugins/DataWarehouse.Plugins.AedsCore/**
  - DataWarehouse.SDK/Hardware/**
autonomous: true

must_haves:
  truths:
    - "AI-driven replication features reach production-ready state"
    - "Consensus algorithms (Paxos, PBFT, ZAB) have working implementations"
    - "Edge/IoT protocols (OPC-UA, Modbus, industrial gateway) fully complete"
    - "AEDS extensions fully operational with all 11 plugins"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateConsensus/Algorithms/"
      provides: "Paxos, PBFT, ZAB implementations"
    - path: "Plugins/DataWarehouse.Plugins.UltimateEdgeComputing/"
      provides: "Edge computing strategies at 100%"
  key_links:
    - from: "UltimateConsensus"
      to: "consensus.* bus topics"
      via: "leader election and log replication"
      pattern: "consensus\\.(elect|replicate)"
---

<objective>
Medium Effort: Domains 5-8 features at 50-79% — Distributed (42), Hardware (12), Edge/IoT (23), AEDS (0) = ~77 features.

Purpose: Complete the partial implementations in distributed systems, hardware integration, and edge/IoT. Consensus algorithms (Paxos, PBFT, ZAB) need full implementation. AI-driven replication needs ML integration. Edge/IoT protocols need protocol-level completion.

Output: ~77 features moved from 50-79% to 100%.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/PLUGIN-CATALOG.md
@.planning/phases/42-feature-verification-matrix/domains-5-8-summary.md
@.planning/phases/42-feature-verification-matrix/significant-items-deferred-v5.md
@.planning/phases/54-feature-gap-closure/54-03-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Distributed — Consensus Algorithms + AI-Driven Replication (42 features)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateReplication/Strategies/**
    Plugins/DataWarehouse.Plugins.UltimateConsensus/Algorithms/**
  </files>
  <action>
Complete all Domain 5 features at 50-79%.

**Consensus Algorithms (3 at 50%)**:
- Paxos (50%): Implement Classic Paxos first — Prepare(n) / Promise(n, v) / Accept(n, v) / Accepted(n, v). Then Multi-Paxos for log replication: stable leader optimization, slot numbering, gap detection, reconfiguration. Use existing Raft infrastructure patterns for network communication.
- PBFT (50%): Pre-prepare / Prepare / Commit phases. View change protocol for leader rotation. Checkpoint protocol for state garbage collection. Message authentication (HMAC) for all messages. Require 3f+1 nodes for f Byzantine faults.
- ZAB (50%): Discovery phase (find latest epoch), Synchronization phase (new followers catch up to leader), Broadcast phase (atomic broadcast with FIFO ordering). Leader election via epoch-based protocol.

NOTE: These are academically important but Raft covers most use cases. Implement solid but don't over-engineer. Each should follow the same strategy pattern as existing Multi-Raft.

**AI-Driven Replication (9 features at 60%)**:
- Adaptive replication: Adjust replication factor based on access pattern analysis (hot data gets more replicas). Use UltimateIntelligence via bus for pattern detection — delegate to intelligence.analyze bus topic.
- Auto-tune replication: Automatically adjust replication parameters (batch size, compression level, sync interval) based on measured throughput/latency. Implement gradient descent on parameters.
- Intelligent replication: Content-aware replication — different strategies based on data classification (financial=sync, logs=async, temp=no-replicate). Delegate classification to intelligence bus.
- Predictive replication: Pre-replicate data to regions where it will be needed based on access pattern prediction. Use time-series forecasting (simple ARIMA or exponential smoothing, not full ML).
- Semantic replication: Replicate semantically related data together to maintain referential integrity across regions.
- Remaining 4: Priority-based, cost-optimized, compliance-aware, latency-optimized replication

**Advanced Active-Active (3 features at 65%)**:
- Multi-region write coordination: Distributed transaction coordinator using 2PC (prepare/commit) across regions, timeout-based abort, compensating transactions for rollback
- Active-active geo-distribution: Topology management with region health monitoring, automatic failover with configurable RPO/RTO targets
- Hot-hot redundancy: Zero-downtime failover with connection draining, request routing during failover window

Pattern: Consensus implementations should use existing network transport from Raft implementation. AI-driven features delegate to UltimateIntelligence via bus — never inline ML.
  </action>
  <verify>
dotnet build DataWarehouse.slnx — zero errors
Paxos: leader election, log replication functional
PBFT: Byzantine fault tolerance with 3f+1 nodes
AI replication: delegates to intelligence bus for analysis
  </verify>
  <done>All 42 Domain 5 features at 50-79% brought to 100%</done>
</task>

<task type="auto">
  <name>Task 2: Hardware, Edge/IoT — Protocol Completion + SDK Ports (35 features)</name>
  <files>
    DataWarehouse.SDK/Hardware/**
    Plugins/DataWarehouse.Plugins.UltimateEdgeComputing/Strategies/**
    Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/Strategies/**
    Plugins/DataWarehouse.Plugins.AedsCore/**
  </files>
  <action>
Complete all Domain 6-8 features at 50-79%.

**Domain 6 — Hardware (12 features at 50-79%)**:
- Cross-language SDK ports (6 at 60%): For Python/Go/Rust/JavaScript SDK bindings, implement the interop layer using C# P/Invoke exports. Create thin wrappers that expose core storage operations (Read, Write, Delete, List, Query) via C ABI. Generate language-specific wrappers using code generation from C# metadata. Each SDK: connection management, error marshaling, async support.
- gRPC service contracts (60%): Define .proto files for core storage operations. Implement gRPC server endpoints. Add streaming support for large data transfers. Schema evolution via proto3 optional fields.
- MessagePack serialization (55%): Implement MessagePack-CSharp integration for high-performance binary serialization. Schema evolution via key-based (not index-based) fields. Add extension type support for custom types (StorageAddress, ObjectIdentity).
- Application platform features (4 at 30-40%): App registration with OAuth 2.0 client credentials, per-app token management with scoping, access policy enforcement via AccessEnforcementInterceptor, per-app observability dashboards (delegate to UniversalObservability).

**Domain 7 — Edge/IoT (23 features at 50-79%)**:
- Industrial gateway (75%): Add SCADA protocols — DNP3 (master/outstation), IEC 60870-5-104 (client/server). CAN bus integration — CAN 2.0A/2.0B frame parsing, J1939 protocol for vehicles. Protocol translation engine — bidirectional mapping between SCADA/CAN and MQTT/Modbus.
- Medical device (70%): Complete HL7 v2 message parsing (MSH/PID/OBX segments), DICOM network service (C-STORE/C-FIND/C-MOVE), FHIR R4 resource validation with StructureDefinition conformance.
- OPC-UA server (65%): Subscription management with configurable sampling intervals, monitored item filtering, event notifications, historical data access, method calls with input/output argument validation.
- Modbus advanced (65%): Complete function code coverage (FC01-FC06, FC15-FC16, FC23), Modbus TCP/RTU/ASCII support, register mapping configuration, data type conversion (float, double, BCD), device polling with configurable intervals.
- RTOS bridge (4 at 25-30%): Implement abstraction layer for VxWorks/QNX/FreeRTOS/Zephyr. Focus on common interface (task scheduling, memory management, interrupt handling) with platform-specific implementations. NOTE: Actual RTOS testing requires hardware — implement with simulation fallback and proper NotSupportedOnPlatformException.
- Remaining edge (10): Edge caching, offline sync, bandwidth estimation, data prioritization, edge analytics

**Domain 8 — AEDS (0 at 50-79%)**:
- AEDS has bimodal distribution (80%+ or <20%). No features in 50-79% range. Skip.

Pattern: Hardware integrations need platform detection (RuntimeInformation.IsOSPlatform) and proper fallback. IoT protocols need proper timeout handling and connection recovery.
  </action>
  <verify>
dotnet build DataWarehouse.slnx — zero errors
gRPC: proto files compile, server endpoints operational
IoT protocols: OPC-UA subscriptions work, Modbus function codes complete
Edge: industrial gateway handles SCADA + CAN
  </verify>
  <done>All 35 Domain 6-8 features at 50-79% brought to 100%</done>
</task>

</tasks>

<verification>
- dotnet build DataWarehouse.slnx succeeds with 0 errors, 0 warnings
- dotnet test passes all existing tests
</verification>

<success_criteria>
- ~77 features moved from 50-79% to 100%
- Zero build errors or warnings
</success_criteria>

<output>
After completion, create `.planning/phases/54-feature-gap-closure/54-07-SUMMARY.md`
</output>
