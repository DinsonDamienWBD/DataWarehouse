---
phase: 66-integration
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - DataWarehouse.Tests/Integration/BuildHealthTests.cs
  - DataWarehouse.Tests/Integration/ProjectReferenceTests.cs
autonomous: true

must_haves:
  truths:
    - "Full solution builds with 0 errors and 0 warnings across all 70+ projects"
    - "No plugin references another plugin directly (SDK-only dependencies)"
    - "All new v5.0 plugins are included in the solution file"
  artifacts:
    - path: "DataWarehouse.Tests/Integration/BuildHealthTests.cs"
      provides: "Compilation verification tests"
      min_lines: 80
    - path: "DataWarehouse.Tests/Integration/ProjectReferenceTests.cs"
      provides: "Plugin isolation verification tests"
      min_lines: 60
  key_links:
    - from: "DataWarehouse.slnx"
      to: "All plugin .csproj files"
      via: "Solution file includes"
      pattern: "DataWarehouse\\.Plugins\\."
---

<objective>
Verify full solution build health and plugin isolation after all v5.0 phases (52-65) complete.

Purpose: Gate check -- nothing else can integrate if the solution does not compile cleanly with all 70+ projects and all plugin isolation constraints are maintained.
Output: Build health tests and plugin reference isolation tests.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/PLUGIN-CATALOG.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Full solution build verification and new project inclusion check</name>
  <files>DataWarehouse.Tests/Integration/BuildHealthTests.cs</files>
  <action>
  Run `dotnet build DataWarehouse.slnx` and verify 0 errors, 0 warnings.

  Create BuildHealthTests.cs in DataWarehouse.Tests/Integration/ with:
  1. A test that runs `dotnet build` via Process and asserts exit code 0
  2. A test that parses DataWarehouse.slnx and asserts all known plugin .csproj files are included (enumerate Plugins/ directory, compare against slnx entries)
  3. A test that verifies all new v5.0 plugins are present: check for any plugins added by phases 55-63 (e.g., UniversalTags, DataConsciousness, CompliancePassport, ZeroGravityStorage, CryptoTimeLock, SemanticSync, ChaosVaccination, CarbonAware, UniversalFabric -- whatever plugin directories exist under Plugins/)
  4. A test that counts total projects in solution and asserts >= 70

  Use xUnit with [Fact] attributes. Reference DataWarehouse.Tests.csproj patterns for test setup.
  If any v5.0 plugin directories do not exist yet (phases not executed), the test should skip gracefully with a descriptive message rather than fail.
  </action>
  <verify>Run `dotnet test DataWarehouse.Tests/DataWarehouse.Tests.csproj --filter "FullyQualifiedName~BuildHealth"` -- all tests pass or skip with explanation</verify>
  <done>Solution builds cleanly, all projects included, test file exists and passes</done>
</task>

<task type="auto">
  <name>Task 2: Plugin isolation verification -- no cross-plugin references</name>
  <files>DataWarehouse.Tests/Integration/ProjectReferenceTests.cs</files>
  <action>
  Create ProjectReferenceTests.cs in DataWarehouse.Tests/Integration/ with:
  1. For every .csproj under Plugins/, parse XML and extract all ProjectReference elements
  2. Assert that NO ProjectReference points to another plugin project (path must NOT contain "Plugins/DataWarehouse.Plugins.")
  3. Assert that all ProjectReferences point only to DataWarehouse.SDK or DataWarehouse.Shared (the only allowed direct references)
  4. Report any violations with exact file path and offending reference

  Use xUnit. Parse .csproj files as XML using System.Xml.Linq. Enumerate via Directory.GetFiles with recursive search for *.csproj under Plugins/ directory.

  Also verify: no plugin .cs file has a `using DataWarehouse.Plugins.` namespace that references a DIFFERENT plugin (grep-style check via File.ReadAllLines). Exclude the plugin's own namespace.
  </action>
  <verify>Run `dotnet test DataWarehouse.Tests/DataWarehouse.Tests.csproj --filter "FullyQualifiedName~ProjectReference"` -- all tests pass</verify>
  <done>Zero cross-plugin references detected, all plugins reference only SDK/Shared</done>
</task>

</tasks>

<verification>
- `dotnet build DataWarehouse.slnx` exits with code 0
- `dotnet test` for BuildHealth and ProjectReference tests all pass
- No cross-plugin dependencies detected
</verification>

<success_criteria>
Full solution compiles with 0 errors, 0 warnings. All plugins are in the solution. No plugin references another plugin directly.
</success_criteria>

<output>
After completion, create `.planning/phases/66-integration/66-01-SUMMARY.md`
</output>
