---
phase: 65.4-comprehensive-strategy-dispatch-migration
plan: 08
type: execute
wave: 4
depends_on: ["65.4-03", "65.4-04"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateCompliance/UltimateCompliancePlugin.cs
  - Plugins/DataWarehouse.Plugins.UniversalObservability/UniversalObservabilityPlugin.cs
  - Plugins/DataWarehouse.Plugins.UniversalDashboards/UniversalDashboardsPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataCatalog/UltimateDataCatalogPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataFabric/UltimateDataFabricPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataGovernance/UltimateDataGovernancePlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataIntegration/UltimateDataIntegrationPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataLake/UltimateDataLakePlugin.cs
autonomous: true

must_haves:
  truths:
    - "Pattern B inline registry plugins (AccessControl, Compliance, Observability, Dashboards) use inherited dispatch"
    - "Pattern C inline class registry plugins (DataCatalog, DataFabric, DataGovernance, DataIntegration, DataLake) use inherited dispatch"
    - "All 9 plugins build with 0 errors"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs"
      provides: "Migrated access control plugin"
      contains: "RegisterSecurityStrategy|RegisterStrategy"
    - path: "Plugins/DataWarehouse.Plugins.UniversalObservability/UniversalObservabilityPlugin.cs"
      provides: "Migrated observability plugin"
      contains: "RegisterObservabilityStrategy|RegisterStrategy"
  key_links:
    - from: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs"
      to: "DataWarehouse.SDK/Contracts/Hierarchy/Feature/SecurityPluginBase.cs"
      via: "inherited security strategy dispatch"
      pattern: "RegisterSecurityStrategy|SecurityStrategyRegistry"
---

<objective>
Migrate Pattern B (inline registry) and Pattern C (inline class registry) plugins to inherited base class dispatch. These are 9 plugins that have registry logic embedded directly in the plugin file.

Purpose: Removes the most tightly-coupled custom registries where registry code is interleaved with plugin logic.
Output: 9 plugins using inherited dispatch, inline registry code removed or marked [Obsolete].
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/phases/65.4-comprehensive-strategy-dispatch-migration/65.4-01-SUMMARY.md
@.planning/phases/65.4-comprehensive-strategy-dispatch-migration/65.4-03-SUMMARY.md
@.planning/phases/65.4-comprehensive-strategy-dispatch-migration/65.4-04-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate Pattern B inline registry plugins (AccessControl, Compliance, Observability, Dashboards)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/UltimateAccessControlPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateCompliance/UltimateCompliancePlugin.cs
    Plugins/DataWarehouse.Plugins.UniversalObservability/UniversalObservabilityPlugin.cs
    Plugins/DataWarehouse.Plugins.UniversalDashboards/UniversalDashboardsPlugin.cs
  </files>
  <action>
Pattern B plugins have BoundedDictionary fields and Register/Get methods INLINE in the plugin class. For each:

**UltimateAccessControl** (inherits SecurityPluginBase):
1. Read the plugin file. Find: `BoundedDictionary<string, IAccessControlStrategy>` or similar field, plus inline `RegisterStrategy()`/`GetStrategy()` methods
2. Remove the BoundedDictionary field -- replace with inherited `SecurityStrategyRegistry` from SecurityPluginBase
3. Replace inline `RegisterStrategy()` body to call `RegisterSecurityStrategy()` (inherited), OR if IAccessControlStrategy does not extend ISecurityStrategy, use PluginBase.StrategyRegistry with `RegisterStrategy()` directly
4. Replace inline `GetStrategy()` with inherited `SecurityStrategyRegistry.Get()` or `ResolveStrategy<>()`
5. Remove assembly scanning code -- use `DiscoverStrategiesFromAssembly()`

**UltimateCompliance** (inherits SecurityPluginBase or FeaturePluginBase):
1. Same pattern -- find inline BoundedDictionary for IComplianceStrategy
2. Replace with inherited dispatch. IComplianceStrategy exists in SDK (`DataWarehouse.SDK.Contracts.Compliance`). Use typed registry if base has one, otherwise PluginBase.StrategyRegistry
3. Remove inline registry methods

**UniversalObservability** (inherits ObservabilityPluginBase):
1. Find inline BoundedDictionary for IObservabilityStrategy
2. Replace with inherited `ObservabilityStrategyRegistry` from ObservabilityPluginBase (Plan 03)
3. Replace `RegisterObservabilityStrategy()` calls

**UniversalDashboards** (check base class):
1. Find inline BoundedDictionary for DashboardStrategyBase
2. Replace with inherited dispatch. If DashboardStrategyBase extends IStrategy, use PluginBase.StrategyRegistry
3. Remove inline registry methods

For ALL: Keep methods that are genuinely different from StrategyRegistry<T> (e.g., custom filtering, business-logic-aware resolution). Only remove methods that are pure CRUD on the BoundedDictionary.

CRITICAL: Each plugin may have different field names and method signatures. READ the file first, then plan the migration. Zero regression.
  </action>
  <verify>
Run: `dotnet build Plugins/DataWarehouse.Plugins.UltimateAccessControl/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateCompliance/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UniversalObservability/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UniversalDashboards/ --no-restore` -- 0 errors each.
  </verify>
  <done>All 4 Pattern B plugins migrated. Inline registry code replaced with inherited dispatch.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate Pattern C inline class registry plugins (DataCatalog, DataFabric, DataGovernance, DataIntegration, DataLake)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateDataCatalog/UltimateDataCatalogPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataFabric/UltimateDataFabricPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataGovernance/UltimateDataGovernancePlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataIntegration/UltimateDataIntegrationPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataLake/UltimateDataLakePlugin.cs
  </files>
  <action>
Pattern C plugins have a NESTED or SIBLING class acting as a registry within the same file. For each:

**All 5 DataManagement plugins** (these all likely inherit DataManagementPluginBase):
1. Read each plugin file. Find the nested/sibling registry class (e.g., `DataCatalogStrategyRegistry`, `FabricStrategyRegistry`, etc.)
2. These classes typically have: BoundedDictionary field, Register(), Get(), GetAll(), Discover() methods
3. Replace usage in the plugin class with inherited dispatch from DataManagementPluginBase (Plan 04) or PluginBase.StrategyRegistry
4. Mark the nested/sibling registry class with `[Obsolete]` -- do NOT delete (may be referenced by other code in the plugin)
5. Update the plugin's initialization code to use inherited registration methods

These plugins share the same DataManagement domain, so the migration is highly uniform:
- `_registry.Register(strategy)` -> `RegisterStrategy(strategy)` or typed method
- `_registry.Get(id)` -> base class `.Get(id)`
- `_registry.GetAll()` -> base class `.GetAll()`
- `_registry.Discover(assembly)` -> `DiscoverStrategiesFromAssembly(assembly)`

CRITICAL: Zero regression. Read each file carefully -- some may have additional custom methods beyond standard CRUD.
  </action>
  <verify>
Run build for all 5 plugins: `dotnet build Plugins/DataWarehouse.Plugins.UltimateDataCatalog/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateDataFabric/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateDataGovernance/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateDataIntegration/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateDataLake/ --no-restore` -- 0 errors each.
  </verify>
  <done>All 5 Pattern C plugins migrated. Inline registry classes marked [Obsolete].</done>
</task>

</tasks>

<verification>
- All 9 plugins build with 0 errors
- Inline BoundedDictionary registry fields removed from plugin classes
- Inline/nested registry classes marked [Obsolete]
</verification>

<success_criteria>
All Pattern B and Pattern C plugins migrated to inherited dispatch. This accounts for 9 of ~24 plugins with custom registries.
</success_criteria>

<output>
After completion, create `.planning/phases/65.4-comprehensive-strategy-dispatch-migration/65.4-08-SUMMARY.md`
</output>
