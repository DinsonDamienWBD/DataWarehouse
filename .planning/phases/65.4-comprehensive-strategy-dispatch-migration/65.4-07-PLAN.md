---
phase: 65.4-comprehensive-strategy-dispatch-migration
plan: 07
type: execute
wave: 3
depends_on: ["65.4-01", "65.4-03", "65.4-04"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateSDKPorts/UltimateSDKPortsPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateSDKPorts/SDKPortStrategyRegistry.cs
  - Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/UltimateIoTIntegrationPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/IoTStrategyRegistry.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataProtection/UltimateDataProtectionPlugin.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataProtection/DataProtectionStrategyRegistry.cs
  - Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/UltimateDatabaseProtocolPlugin.cs
autonomous: true

must_haves:
  truths:
    - "UltimateSDKPorts uses inherited dispatch instead of standalone SDKPortStrategyRegistry"
    - "UltimateIoTIntegration uses inherited dispatch instead of standalone IoTStrategyRegistry"
    - "UltimateDataProtection uses inherited dispatch instead of standalone DataProtectionStrategyRegistry"
    - "UltimateDatabaseProtocol uses inherited dispatch instead of inline registry"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateSDKPorts/UltimateSDKPortsPlugin.cs"
      provides: "Migrated SDK ports plugin"
      contains: "RegisterStrategy|Register.*Strategy"
    - path: "Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/UltimateIoTIntegrationPlugin.cs"
      provides: "Migrated IoT plugin"
      contains: "RegisterStrategy|Register.*Strategy"
  key_links:
    - from: "Plugins/DataWarehouse.Plugins.UltimateSDKPorts/UltimateSDKPortsPlugin.cs"
      to: "DataWarehouse.SDK/Contracts/PluginBase.cs"
      via: "inherited strategy dispatch"
      pattern: "RegisterStrategy|StrategyRegistry"
---

<objective>
Migrate UltimateSDKPorts, UltimateIoTIntegration, UltimateDataProtection, and UltimateDatabaseProtocol plugins from custom registries to inherited base class dispatch.

Purpose: These 4 plugins complete the Pattern A standalone registry migrations (plus 1 Pattern B inline).
Output: 4 plugins using base class dispatch, standalone registries marked [Obsolete].
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/phases/65.4-comprehensive-strategy-dispatch-migration/65.4-01-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate UltimateSDKPorts and UltimateIoTIntegration</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateSDKPorts/UltimateSDKPortsPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateSDKPorts/SDKPortStrategyRegistry.cs
    Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/UltimateIoTIntegrationPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/IoTStrategyRegistry.cs
  </files>
  <action>
Follow the same migration process as Plans 05-06:

**UltimateSDKPorts:**
1. Read plugin to determine base class and find all `SDKPortStrategyRegistry` references
2. This likely inherits PlatformPluginBase (from Plan 04). Replace with inherited dispatch
3. Map: `Register()` -> `RegisterStrategy()` or typed method, `GetStrategy()` -> inherited `.Get()`, `DiscoverStrategies()` -> `DiscoverStrategiesFromAssembly()`
4. Mark `SDKPortStrategyRegistry.cs` with `[Obsolete]`

**UltimateIoTIntegration:**
1. Read plugin, find all `IoTStrategyRegistry` references
2. Determine base class, replace with inherited dispatch
3. Mark `IoTStrategyRegistry.cs` with `[Obsolete]`

Keep thin wrappers for custom convenience methods.
  </action>
  <verify>
Run: `dotnet build Plugins/DataWarehouse.Plugins.UltimateSDKPorts/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/ --no-restore` -- 0 errors.
  </verify>
  <done>UltimateSDKPorts and UltimateIoTIntegration migrated. Custom registries marked [Obsolete].</done>
</task>

<task type="auto">
  <name>Task 2: Migrate UltimateDataProtection and UltimateDatabaseProtocol</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateDataProtection/UltimateDataProtectionPlugin.cs
    Plugins/DataWarehouse.Plugins.UltimateDataProtection/DataProtectionStrategyRegistry.cs
    Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/UltimateDatabaseProtocolPlugin.cs
  </files>
  <action>
**UltimateDataProtection:**
1. Read plugin, find all `DataProtectionStrategyRegistry` references
2. Determine base class (likely SecurityPluginBase from Plan 03), replace with inherited dispatch
3. Mark `DataProtectionStrategyRegistry.cs` with `[Obsolete]`

**UltimateDatabaseProtocol:**
1. This has an INLINE registry (Pattern B -- `DatabaseProtocolStrategyRegistry` defined within or alongside the plugin class)
2. Read the plugin file to find the inline registry pattern (BoundedDictionary field + Register/Get methods)
3. Replace the inline BoundedDictionary field with usage of inherited base class StrategyRegistry
4. Remove inline Register/GetStrategy methods that duplicate base class functionality
5. Keep the inline class definition but add `[Obsolete]` if it's referenced elsewhere, OR remove it if only used within the plugin file

CRITICAL: Zero regression. All strategy resolution must work identically.
  </action>
  <verify>
Run: `dotnet build Plugins/DataWarehouse.Plugins.UltimateDataProtection/ --no-restore && dotnet build Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/ --no-restore` -- 0 errors.
  </verify>
  <done>UltimateDataProtection and UltimateDatabaseProtocol migrated. Custom registries deprecated.</done>
</task>

</tasks>

<verification>
- All 4 plugins build with 0 errors
- Custom registry files/classes marked [Obsolete]
</verification>

<success_criteria>
All 4 plugins migrated to base class dispatch. This completes Pattern A standalone registry migrations.
</success_criteria>

<output>
After completion, create `.planning/phases/65.4-comprehensive-strategy-dispatch-migration/65.4-07-SUMMARY.md`
</output>
