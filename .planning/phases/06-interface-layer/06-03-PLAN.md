---
phase: 06-interface-layer
plan: 03
type: execute
wave: 2
depends_on: ["06-01"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/GrpcInterfaceStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/GrpcWebStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/ConnectRpcStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/TwirpStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/JsonRpcStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/XmlRpcStrategy.cs
  - Metadata/TODO.md
autonomous: true

must_haves:
  truths:
    - "6 RPC strategies exist and compile with production-ready request handling"
    - "Each strategy implements correct RPC protocol semantics"
    - "gRPC strategies support HTTP/2 and bidirectional streaming declarations"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/"
      provides: "6 RPC protocol strategy implementations"
  key_links:
    - from: "Strategies/RPC/*.cs"
      to: "InterfaceStrategyBase"
      via: "class inheritance"
      pattern: "InterfaceStrategyBase"
---

<objective>
Implement 6 RPC protocol strategies (T109.B3)

Purpose: Provide production-ready RPC interface strategies for remote procedure calls including gRPC, gRPC-Web, Connect RPC, Twirp, JSON-RPC 2.0, and XML-RPC.

Output: 6 strategy files in Strategies/RPC/ directory, all compiling cleanly.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-interface-layer/06-RESEARCH.md
@.planning/phases/06-interface-layer/06-01-SUMMARY.md
@DataWarehouse.SDK/Contracts/Interface/IInterfaceStrategy.cs
@DataWarehouse.SDK/Contracts/Interface/InterfaceStrategyBase.cs
@DataWarehouse.SDK/Contracts/Interface/InterfaceCapabilities.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement 6 RPC strategies in Strategies/RPC/ directory</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/GrpcInterfaceStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/GrpcWebStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/ConnectRpcStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/TwirpStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/JsonRpcStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Strategies/RPC/XmlRpcStrategy.cs
  </files>
  <action>
Create 6 RPC strategy files. Each must extend InterfaceStrategyBase, implement IPluginInterfaceStrategy, and have production-ready HandleRequestAsyncCore.

**GrpcInterfaceStrategy** (StrategyId: "grpc"):
- Protocol: InterfaceProtocol.gRPC
- Use InterfaceCapabilities.CreateGrpcDefaults() (HTTP/2, bidirectional streaming, TLS required)
- HandleRequestAsync: Parse gRPC service/method from Path (format: /package.Service/Method), serialize request via protobuf-like binary framing, route via message bus, return framed response
- Support unary RPC, server streaming, client streaming, bidirectional streaming declarations
- Content-Type: application/grpc, application/grpc+proto

**GrpcWebStrategy** (StrategyId: "grpc-web"):
- Protocol: InterfaceProtocol.gRPC
- Adapts gRPC for browser clients that cannot use HTTP/2 directly
- HandleRequestAsync: Accept application/grpc-web, base64-encode/decode frames, translate between HTTP/1.1 and gRPC framing
- Support CORS headers for cross-origin browser requests

**ConnectRpcStrategy** (StrategyId: "connect-rpc"):
- Protocol: InterfaceProtocol.gRPC
- Implements Buf Connect RPC protocol (simpler than gRPC, works over HTTP/1.1 and HTTP/2)
- HandleRequestAsync: Accept both application/json and application/proto, use HTTP POST with path-based routing
- Support unary and streaming via Server-Sent Events

**TwirpStrategy** (StrategyId: "twirp"):
- Protocol: InterfaceProtocol.gRPC
- Implements Twitch's Twirp protocol (protobuf over HTTP)
- HandleRequestAsync: Route via /twirp/package.Service/Method, accept JSON or protobuf, return same format
- Simple error format: {"code": "not_found", "msg": "..."}

**JsonRpcStrategy** (StrategyId: "json-rpc"):
- Protocol: InterfaceProtocol.JsonRpc
- Implements JSON-RPC 2.0 specification
- HandleRequestAsync: Parse {"jsonrpc": "2.0", "method": "...", "params": [...], "id": N}, route method via message bus, return {"jsonrpc": "2.0", "result": ..., "id": N}
- Support batch requests (array of requests), notifications (no id = no response)
- Error codes: -32700 (parse error), -32600 (invalid request), -32601 (method not found), -32602 (invalid params), -32603 (internal error)

**XmlRpcStrategy** (StrategyId: "xml-rpc"):
- Protocol: InterfaceProtocol.XmlRpc
- Implements XML-RPC specification
- HandleRequestAsync: Parse <methodCall><methodName>...<params>, route via message bus, return <methodResponse>
- Support all XML-RPC types: int, double, boolean, string, dateTime.iso8601, base64, struct, array
- Fault responses: <fault><value><struct> with faultCode and faultString

All strategies must use message bus for data operations, handle errors gracefully, include full XML documentation, be internal sealed classes.
  </action>
  <verify>
`dotnet build Plugins/DataWarehouse.Plugins.UltimateInterface/DataWarehouse.Plugins.UltimateInterface.csproj` -- zero errors.
Verify 6 .cs files exist in Strategies/RPC/.
  </verify>
  <done>6 RPC strategies implemented with protocol-specific request/response handling.</done>
</task>

<task type="auto">
  <name>Task 2: Mark T109.B3 complete in TODO.md</name>
  <files>Metadata/TODO.md</files>
  <action>Find lines `| 109.B3.1 |` through `| 109.B3.6 |` and change `[ ]` to `[x]`.</action>
  <verify>Grep TODO.md for `109.B3` -- all 6 should show `[x]`.</verify>
  <done>T109.B3.1-B3.6 marked [x] in TODO.md.</done>
</task>

</tasks>

<verification>
- `dotnet build` passes with zero errors
- 6 RPC strategy files exist and extend InterfaceStrategyBase
- T109.B3.1-B3.6 marked [x]
</verification>

<success_criteria>
6 RPC strategies are production-ready with correct protocol semantics for gRPC, gRPC-Web, Connect RPC, Twirp, JSON-RPC 2.0, and XML-RPC.
</success_criteria>

<output>
After completion, create `.planning/phases/06-interface-layer/06-03-SUMMARY.md`
</output>
