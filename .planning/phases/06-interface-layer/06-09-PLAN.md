---
phase: 06-interface-layer
plan: 09
type: execute
wave: 4
depends_on: ["06-08"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Services/ProtocolBridgeService.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Services/RequestRoutingService.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Services/EndpointDiscoveryService.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Services/UnifiedAuthService.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/Services/ApiAnalyticsService.cs
  - Plugins/DataWarehouse.Plugins.UltimateInterface/UltimateInterfacePlugin.cs
  - Metadata/TODO.md
autonomous: true

must_haves:
  truths:
    - "Advanced features (C1-C8) are implemented as services"
    - "Migration guide exists and deprecated plugins are marked"
    - "Final build passes with all 68+ strategies discovered by orchestrator"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateInterface/Services/"
      provides: "5 advanced feature services"
  key_links:
    - from: "Services/*.cs"
      to: "UltimateInterfacePlugin.cs"
      via: "service registration in orchestrator"
      pattern: "Service"
---

<objective>
Implement advanced features (T109.C) and migration (T109.D), finalize phase

Purpose: Complete Phase C advanced features (multi-protocol endpoints, protocol translation, unified auth, request transformation, API analytics, and cross-plugin integrations) and Phase D migration (update references, deprecate individual plugins, create migration guide). This plan also performs the final build verification and phase completion check.

Output: Advanced feature services, migration documentation, clean build with all strategies, phase gate verification.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/06-interface-layer/06-RESEARCH.md
@.planning/phases/06-interface-layer/06-01-SUMMARY.md
@Plugins/DataWarehouse.Plugins.UltimateInterface/UltimateInterfacePlugin.cs
@DataWarehouse.SDK/Contracts/Interface/IInterfaceStrategy.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement advanced features (C1-C8) and migration (D1-D5)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateInterface/Services/ProtocolBridgeService.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Services/RequestRoutingService.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Services/EndpointDiscoveryService.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Services/UnifiedAuthService.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/Services/ApiAnalyticsService.cs
    Plugins/DataWarehouse.Plugins.UltimateInterface/UltimateInterfacePlugin.cs
  </files>
  <action>
**Phase C: Advanced Features (Services/)**

C1 - ProtocolBridgeService: Multi-protocol endpoint support. Accept request via any protocol, translate to target protocol. Use strategy registry to find source/target strategies. Map InterfaceRequest between protocols (REST path to gRPC service/method, GraphQL query to REST operations, etc.). Track bridge statistics.

C2 - RequestRoutingService: Protocol translation gateway. Route requests from one protocol to another based on routing rules. Support content-based routing (inspect body), header-based routing, and path-based routing. Return translated response in caller protocol format.

C3 - UnifiedAuthService: Unified authentication across all protocols. Support JWT validation, API key verification, mTLS certificate checking. Integrate with UltimateAccessControl (T95) via message bus topic "security.auth.verify". Fallback to basic auth when T95 unavailable. Apply auth to all strategy StartAsync/HandleRequestAsync calls.

C4 - RequestRoutingService (extend): Request/response transformation. Support JSON-to-XML, XML-to-JSON, protobuf-to-JSON bidirectional transformation. Content-Type header drives transformation. Use System.Text.Json and XmlSerializer.

C5 - ApiAnalyticsService: API analytics and usage tracking. Track per-strategy request count, latency (p50/p95/p99), error rate, bytes transferred. Publish metrics to UniversalObservability (T100) via message bus topic "metrics.publish". Provide dashboard data via HandleStatsAsync.

C6-C8 - Integration wiring: Wire UnifiedAuthService into UltimateInterfacePlugin message handlers. Wire ApiAnalyticsService into request pipeline. Wire NLP/Intelligence integration for natural language queries.

**Phase D: Migration**

D1: Update UltimateInterfacePlugin to register itself as replacement for old plugins (RestInterface, GrpcInterface, GraphQlApi, SqlInterface). Add [Obsolete] comments on old plugin names in knowledge registration.

D2: Add migration guide as XML doc comments on UltimateInterfacePlugin documenting: old plugin -> new strategy mapping, configuration migration, breaking changes.

D3: Mark individual interface plugins as deprecated by adding [Obsolete("Use UltimateInterface strategy instead")] notices. File actual deletion deferred to Phase 18.

D4-D5: Deferred to Phase 18 (file deletion). Mark as [x] with note "Deferred to Phase 18".

Update TODO.md: Mark C1-C8 and D1-D5 as [x].
  </action>
  <verify>
dotnet build Plugins/DataWarehouse.Plugins.UltimateInterface -- zero errors.
Verify Services/ directory has 5 .cs files.
  </verify>
  <done>Advanced features and migration complete. All Phase C services implemented. Phase D migration started (D4-D5 deferred to Phase 18).</done>
</task>

<task type="auto">
  <name>Task 2: Final phase gate - verify all strategies and update TODO.md</name>
  <files>Metadata/TODO.md</files>
  <action>
1. Run dotnet build for the entire solution to verify no cross-project breakage.
2. Count total strategies discovered by auto-discovery (grep for classes implementing IPluginInterfaceStrategy or extending InterfaceStrategyBase).
3. Update TODO.md:
   - Mark C1-C8 as [x]: Find lines 109.C1 through 109.C8
   - Mark D1-D3 as [x], D4-D5 as [x] with "Deferred to Phase 18" note
   - Update the T109 parent status from "[x] Complete - 6 strategies" to "[x] Complete - {N} strategies" reflecting actual count
4. Verify all ROADMAP success criteria for Phase 6:
   - Plugin orchestrator discovers and registers all strategies
   - REST strategies (REST, OpenAPI, JSON:API, HATEOAS, OData, Falcor) expose operations
   - RPC strategies (gRPC, gRPC-Web, Connect, Twirp, JSON-RPC, XML-RPC) work
   - Query strategies (GraphQL, SQL, Relay, Apollo, Hasura, PostGraphile, Prisma) enable querying
   - Real-time strategies (WebSocket, SSE, Long Polling, Socket.IO, SignalR) push updates
   - Messaging strategies (MQTT, AMQP, STOMP, NATS, Kafka REST) integrate brokers
   - Conversational strategies (Slack, Teams, Discord, Alexa, Google, Siri, ChatGPT, Claude MCP) enable interaction
  </action>
  <verify>
dotnet build passes for full solution.
Grep TODO.md for T109.C and T109.D -- all marked [x].
T109 parent task shows updated strategy count.
  </verify>
  <done>Phase 6 complete. All T109 sub-tasks verified. ROADMAP success criteria satisfied. Ready for Phase 7.</done>
</task>

</tasks>

<verification>
- Full solution builds with zero errors
- All T109 sub-tasks (A, B1-B11, C1-C8, D1-D5) marked [x]
- ROADMAP Phase 6 success criteria validated
- Strategy count updated in T109 parent status
</verification>

<success_criteria>
Phase 6 complete: UltimateInterface plugin provides 68+ protocol strategies across 7 categories with advanced features, unified auth, analytics, and migration guides. All ROADMAP success criteria validated.
</success_criteria>

<output>
After completion, create `.planning/phases/06-interface-layer/06-09-SUMMARY.md`
</output>
