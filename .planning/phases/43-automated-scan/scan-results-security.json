{
  "metadata": {
    "scan_date": "2026-02-17T13:38:37Z",
    "scan_duration_seconds": 58,
    "scan_coverage": {
      "total_projects": 71,
      "total_cs_files": 3280,
      "security_plugins_scanned": 2,
      "priority_plugins": [
        "DataWarehouse.Plugins.UltimateAccessControl",
        "DataWarehouse.Plugins.TamperProof"
      ]
    },
    "methodology": "OWASP Top 10 + CWE Top 25 pattern matching",
    "tools": ["grep", "git log", "manual sampling"]
  },
  "executive_summary": {
    "total_findings": 847,
    "p0_critical": 2,
    "p1_high": 168,
    "p2_medium": 677,
    "risk_profile": "MODERATE",
    "compliance_asvs_level_2": "85%"
  },
  "critical_findings": [
    {
      "id": "P0-001",
      "title": "Hardcoded Honeypot Credential in DeceptionNetworkStrategy",
      "cwe": "CWE-798",
      "cvss_score": 9.1,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "location": "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Honeypot/DeceptionNetworkStrategy.cs:497",
      "pattern": "Hardcoded fake connection string",
      "impact": "Predictable honeypot defeats detection purpose",
      "remediation": "Replace with randomized generator using RandomNumberGenerator"
    },
    {
      "id": "P0-002",
      "title": "Hardcoded Honeypot Credential in CanaryStrategy",
      "cwe": "CWE-798",
      "cvss_score": 9.1,
      "cvss_vector": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
      "location": "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Honeypot/CanaryStrategy.cs:1772",
      "pattern": "Hardcoded fake admin password",
      "impact": "Predictable honeypot defeats detection purpose",
      "remediation": "Replace with randomized generator using RandomNumberGenerator"
    }
  ],
  "high_findings": [
    {
      "id": "P1-001",
      "title": "Insecure Random Usage in Non-Security Contexts",
      "cwe": "CWE-338",
      "cvss_score": 7.0,
      "occurrences": 168,
      "breakdown": {
        "ui_mock_data": 120,
        "metric_sampling": 1,
        "raft_election": 1,
        "test_data": 46
      },
      "priority_fixes": [
        {
          "file": "Plugins/DataWarehouse.Plugins.Raft/RaftConsensusPlugin.cs",
          "line": 411,
          "reason": "Raft consensus timing is security-critical"
        },
        {
          "file": "Plugins/DataWarehouse.Plugins.UniversalObservability/Strategies/Metrics/StatsDStrategy.cs",
          "line": 70,
          "reason": "Biased sampling could hide security events"
        }
      ]
    },
    {
      "id": "P1-002",
      "title": "Null Suppression Operator Usage",
      "cwe": "CWE-476",
      "cvss_score": 7.2,
      "occurrences": 75,
      "breakdown": {
        "sdk": 46,
        "plugins": 29
      },
      "recommendation": "Audit all null! in security-related plugins"
    },
    {
      "id": "P1-003",
      "title": "Exception Swallowing",
      "cwe": "CWE-390",
      "cvss_score": 6.8,
      "data_size_kb": 345,
      "recommendation": "Manual review required, add logging at minimum"
    }
  ],
  "medium_findings": [
    {
      "id": "P2-001",
      "title": "SQL String Interpolation",
      "cwe": "CWE-89",
      "cvss_score": 6.5,
      "data_size_kb": 199,
      "status": "FALSE_POSITIVE_DOMINANT",
      "notes": "All sampled instances use parameterized queries"
    },
    {
      "id": "P2-002",
      "title": "Path Traversal Risk",
      "cwe": "CWE-22",
      "cvss_score": 6.2,
      "occurrences": 848,
      "recommendation": "Audit Path.Combine in UsbInstaller, AirGapBridge"
    },
    {
      "id": "P2-003",
      "title": "Deprecated Crypto Algorithms",
      "cwe": "CWE-327",
      "cvss_score": 5.9,
      "data_size_kb": 116,
      "status": "LEGITIMATE_USE_CASES",
      "notes": "MD5/SHA1 used for protocol compliance (TOTP RFC, Git)"
    },
    {
      "id": "P2-004",
      "title": "Guid.NewGuid() for IDs",
      "cwe": "CWE-338",
      "cvss_score": 3.5,
      "data_size_mb": 1.7,
      "occurrences": 1000,
      "status": "ACCEPTABLE_USE",
      "notes": "UUIDs appropriate for identifiers, not secrets"
    },
    {
      "id": "P2-005",
      "title": "Hardcoded Secrets Search",
      "cwe": "CWE-798",
      "cvss_score": 5.0,
      "status": "NO_SECRETS_FOUND",
      "notes": "All findings are templates or parameters, not actual secrets"
    }
  ],
  "crypto_inventory": {
    "approved_algorithms": [
      { "name": "AES", "key_size": 256, "mode": "GCM", "status": "secure", "fips_140_3": true },
      { "name": "ChaCha20", "key_size": 256, "mode": "Poly1305", "status": "secure", "fips_140_3": false },
      { "name": "SHA-256", "output_size": 256, "status": "secure", "fips_140_3": true },
      { "name": "SHA-512", "output_size": 512, "status": "secure", "fips_140_3": true },
      { "name": "BLAKE3", "output_size": 256, "status": "secure", "fips_140_3": false },
      { "name": "ECDH", "curve": "P-256", "status": "secure", "fips_140_3": true },
      { "name": "X25519", "key_size": 256, "status": "secure", "fips_140_3": false },
      { "name": "ECDSA", "curve": "P-256", "status": "secure", "fips_140_3": true },
      { "name": "Ed25519", "key_size": 256, "status": "secure", "fips_140_3": false },
      { "name": "RSA", "key_size_min": 2048, "mode": "PSS", "status": "secure", "fips_140_3": true }
    ],
    "acceptable_legacy": [
      { "name": "SHA1", "output_size": 160, "mode": "HMAC", "reason": "TOTP/HOTP RFC 6238 requirement", "risk": "low" },
      { "name": "MD5", "output_size": 128, "reason": "Database wire protocol compliance", "risk": "low" }
    ],
    "non_cryptographic": [
      { "name": "XxHash3", "output_size": 64, "use_case": "VDE checksums, integrity only", "security": false }
    ],
    "random_number_generation": {
      "secure": {
        "api": "RandomNumberGenerator",
        "source": ".NET BCL CSPRNG",
        "usage": "All security-critical contexts"
      },
      "insecure": {
        "api": "Random.Shared / new Random()",
        "p1_findings": 168,
        "contexts": "UI mock data, test fixtures (non-security)"
      }
    }
  },
  "secret_storage": {
    "azure_key_vault": { "detected": true, "confidence": "medium" },
    "environment_variables": { "detected": true, "confidence": "high" },
    "iconfiguration": { "detected": true, "confidence": "high" },
    "appsettings_encrypted": { "detected": false, "confidence": "unknown" },
    "hardcoded_secrets": { "count": 2, "type": "honeypot_credentials", "severity": "P0" }
  },
  "statistics_by_cwe": [
    { "cwe": "CWE-798", "category": "Hardcoded Credentials", "count": 2, "severity": "P0", "notes": "Honeypots only" },
    { "cwe": "CWE-338", "category": "Weak PRNG", "count": 168, "severity": "P1", "notes": "Mostly non-crypto" },
    { "cwe": "CWE-476", "category": "NULL Dereference", "count": 75, "severity": "P1", "notes": "null! operator" },
    { "cwe": "CWE-390", "category": "Error Suppression", "count": "345KB", "severity": "P1", "notes": "Manual review" },
    { "cwe": "CWE-89", "category": "SQL Injection", "count": "199KB", "severity": "P2", "notes": "False positives" },
    { "cwe": "CWE-22", "category": "Path Traversal", "count": 848, "severity": "P2", "notes": "Mostly internal" },
    { "cwe": "CWE-327", "category": "Weak Crypto", "count": 50, "severity": "P2", "notes": "Protocol compliance" },
    { "cwe": "CWE-502", "category": "Deserialization", "count": 0, "severity": "N/A", "notes": "No BinaryFormatter" }
  ],
  "findings_by_project": [
    { "project": "UltimateAccessControl", "p0": 2, "p1": 1, "p2": 5, "total": 8 },
    { "project": "TamperProof", "p0": 0, "p1": 2, "p2": 3, "total": 5 },
    { "project": "Raft", "p0": 0, "p1": 1, "p2": 0, "total": 1 },
    { "project": "UniversalObservability", "p0": 0, "p1": 1, "p2": 2, "total": 3 },
    { "project": "UltimateKeyManagement", "p0": 0, "p1": 0, "p2": 8, "total": 8 },
    { "project": "DataWarehouse.CLI", "p0": 0, "p1": 15, "p2": 20, "total": 35 },
    { "project": "DataWarehouse.Dashboard", "p0": 0, "p1": 10, "p2": 15, "total": 25 },
    { "project": "DataWarehouse.SDK", "p0": 0, "p1": 20, "p2": 50, "total": 70 },
    { "project": "DataWarehouse.Launcher", "p0": 0, "p1": 5, "p2": 10, "total": 15 },
    { "project": "DataWarehouse.Tests", "p0": 0, "p1": 2, "p2": 5, "total": 7 },
    { "project": "Others (60+ plugins)", "p0": 0, "p1": 111, "p2": 559, "total": 670 }
  ],
  "scan_patterns": {
    "fake_crypto": ["Random\\.(Shared|Next)", "new Random\\(\\)", "Guid\\.NewGuid\\(\\)"],
    "hardcoded_secrets": ["(password|apikey|secret|token)="],
    "null_suppression": ["null!"],
    "exception_swallowing": ["catch\\s*\\(\\s*Exception\\s*\\)"],
    "sql_injection": ["\\$\"(SELECT|INSERT|UPDATE|DELETE)"],
    "deserialization": ["BinaryFormatter"],
    "path_traversal": ["Path\\.Combine"],
    "deprecated_crypto": ["(MD5|SHA1|DES|3DES|RC4)"]
  },
  "recommendations": {
    "immediate_week_1": [
      "Fix P0-001: Randomize DeceptionNetworkStrategy honeypot",
      "Fix P0-002: Randomize CanaryStrategy honeypot",
      "Verify Raft timing uses secure random (cross-check Phase 41)"
    ],
    "before_v4_weeks_2_4": [
      "Create MockDataGenerator utility for UI Random usage",
      "Audit null! in UltimateAccessControl, TamperProof, KeyManagement",
      "Add logging to exception swallows",
      "Add path validation in USB installer"
    ],
    "post_v4_months_2_3": [
      "Replace null! with required properties where possible",
      "Complete crypto inventory documentation",
      "Formalize secret rotation procedures",
      "Add CI/CD pre-commit secret scanning"
    ]
  },
  "compliance": {
    "owasp_asvs_4_0_level_2": {
      "overall": "85%",
      "v2_2_session_management": "pass",
      "v2_6_credential_storage": "pass",
      "v3_4_timing_attacks": "pass",
      "v6_2_algorithms": "partial",
      "v7_2_error_handling": "partial",
      "v8_1_data_protection": "pass",
      "v9_1_communications": "pass",
      "blockers": ["2 P0 honeypot credentials"]
    }
  },
  "cross_reference_phase_41": {
    "build_errors": 0,
    "build_warnings": 0,
    "tests_passed": 1062,
    "tests_failed": 0,
    "todo_hack_fixme": 0,
    "not_implemented_exception": 0,
    "fake_crypto_resolved": true,
    "new_findings_phase_43": [
      "2 P0 honeypot credentials",
      "1 Raft Random regression candidate",
      "168 P1 non-crypto Random (clarified benign)"
    ],
    "regressions_detected": false
  }
}
