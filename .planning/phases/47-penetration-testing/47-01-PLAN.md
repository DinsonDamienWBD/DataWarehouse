---
phase: 47
plan: 47-01
title: "OWASP Top 10 Verification"
depends_on: []
---

# Plan 47-01: OWASP Top 10 Verification

## Goal
Verify DataWarehouse is protected against the OWASP Top 10 security vulnerabilities: Injection, Broken Authentication, Sensitive Data Exposure, XML External Entities (XXE), Broken Access Control, Security Misconfiguration, Cross-Site Scripting (XSS), Insecure Deserialization, Using Components with Known Vulnerabilities, and Insufficient Logging & Monitoring.

## Approach
1. **A01: Injection**:
   - SQL Injection: attempt SQL injection via REST/GraphQL queries (`/api/data?id=1' OR '1'='1`)
   - Command Injection: attempt shell injection via CLI NLP (`dw "show files; rm -rf /"`)
   - NoSQL Injection: attempt MongoDB-style injection if applicable
   - Verify input validation and parameterization prevent all injection attacks
2. **A02: Broken Authentication**:
   - Credential stuffing: attempt login with common username/password lists
   - Session fixation: attempt to reuse/steal session tokens
   - Weak password policy: attempt to set password "123456"
   - MFA bypass: attempt to skip multi-factor authentication
   - Verify authentication enforces strong passwords, MFA, and token expiration
3. **A03: Sensitive Data Exposure**:
   - Plaintext secrets: scan logs/config files for plaintext passwords/keys
   - Unencrypted transport: capture network traffic, verify TLS used everywhere
   - Weak encryption: verify AES-256 or stronger, no MD5/SHA1
   - Data leakage: check error messages for sensitive info (stack traces, SQL queries)
   - Verify all sensitive data encrypted at rest and in transit
4. **A04: XML External Entities (XXE)**:
   - Upload malicious XML: `<!DOCTYPE foo [<!ENTITY xxe SYSTEM "file:///etc/passwd">]>`
   - Test GraphQL, REST, AEDS command parsing
   - Verify XML parser disables external entity resolution
5. **A05: Broken Access Control**:
   - Vertical privilege escalation: regular user attempts admin operation
   - Horizontal privilege escalation: user A attempts to access user B's data
   - Insecure direct object reference: `/api/data/12345` (guess other IDs)
   - Verify RBAC enforced, tenant isolation enforced
6. **A06: Security Misconfiguration**:
   - Default credentials: attempt login with admin/admin, root/root
   - Directory listing: attempt to browse `/api/` or `/data/` directories
   - Verbose error messages: trigger errors, check for stack traces in production mode
   - Unnecessary services: verify only required ports/services enabled
   - Verify secure defaults, minimal attack surface
7. **A07: Cross-Site Scripting (XSS)**:
   - Stored XSS: upload data with `<script>alert('XSS')</script>`, verify sanitized in Dashboard
   - Reflected XSS: inject script in query parameter, verify sanitized
   - DOM XSS: test client-side rendering in Dashboard
   - Verify output encoding prevents all XSS
8. **A08: Insecure Deserialization**:
   - Malicious payload: craft serialized object with code execution payload
   - Test JSON, MessagePack, Protobuf deserialization
   - Verify deserialization validates types and rejects untrusted payloads
9. **A09: Using Components with Known Vulnerabilities**:
   - Run dependency scan: `dotnet list package --vulnerable`
   - Check CVE databases for known vulnerabilities in dependencies
   - Verify all dependencies up-to-date or vulnerabilities mitigated
10. **A10: Insufficient Logging & Monitoring**:
    - Trigger security events: failed login, privilege escalation attempt, data access violation
    - Verify all events logged with timestamp, user, action, outcome
    - Verify logs are tamper-proof (append-only, signed)
    - Verify alerting configured for critical events

## Scope
**In Scope:**
- OWASP Top 10 (2021 edition)
- All API surfaces: REST, gRPC, GraphQL, CLI, Dashboard
- Authentication, authorization, input validation, output encoding
- Dependency vulnerability scanning
- Logging and monitoring

**Out of Scope:**
- Cryptographic deep-dive (Plan 47-02)
- Network security (Plan 47-03)
- Data security (Plan 47-04)
- Infrastructure security (Plan 47-05)
- Performance testing (Phase 46)

## Success Criteria
- [ ] SQL Injection blocked (all attempts rejected with validation error)
- [ ] Command Injection blocked (CLI sanitizes input)
- [ ] Weak passwords rejected (password policy enforced)
- [ ] MFA required (cannot bypass)
- [ ] Session tokens expire (no indefinite sessions)
- [ ] Sensitive data encrypted (logs/config files have no plaintext secrets)
- [ ] TLS enforced (all network traffic encrypted)
- [ ] XXE blocked (malicious XML rejected)
- [ ] Vertical privilege escalation blocked (regular user cannot execute admin commands)
- [ ] Horizontal privilege escalation blocked (user A cannot access user B's data)
- [ ] Default credentials disabled (admin/admin fails)
- [ ] Directory listing disabled (cannot browse API directories)
- [ ] Production error messages sanitized (no stack traces)
- [ ] XSS blocked (stored, reflected, DOM â€” all sanitized)
- [ ] Insecure deserialization blocked (malicious payloads rejected)
- [ ] Zero high/critical CVEs in dependencies
- [ ] Security events logged (failed login, privilege escalation, access violation)
- [ ] Audit logs tamper-proof (signatures valid)

## Output
- `47-01-owasp-verification-report.md`: Test results for each OWASP Top 10 item
- `47-01-attack-logs.txt`: Logs from all attack attempts (evidence of blocking)
- `47-01-vulnerability-scan.json`: Dependency vulnerability scan results
- Updated `.planning/phases/47-penetration-testing/STATUS.md` with pass/fail results
