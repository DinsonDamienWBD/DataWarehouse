---
phase: 47-penetration-testing
plan: 47-v4.5-06
title: "Network & Transport Layer Attacks"
subsystem: network-transport
tags: [pentest, tls, grpc, mqtt, websocket, quic, coap, graphql, security]
dependency-graph:
  requires: ["47-v4.5-01"]
  provides: ["network-transport-findings"]
  affects: ["AedsCore", "UltimateStorage", "AdaptiveTransport", "UltimateConnector", "UltimateDataTransit", "UltimateKeyManagement", "UltimateIntelligence"]
tech-stack:
  patterns: ["TLS census methodology", "protocol-specific attack narratives", "CVSS scoring"]
key-files:
  created:
    - .planning/phases/47-penetration-testing/v4.5-06-NETWORK-FINDINGS.md
key-decisions:
  - "Classified 27 TLS validation callbacks into 4 categories: unconditional bypass, configurable (default secure), conditional, and secure"
  - "Identified gRPC control plane insecure credentials as new critical finding separate from storage bypass"
  - "Documented MQTT topic authorization gap as architectural issue requiring broker-side or application-side ACL"
metrics:
  duration: "292s"
  completed: "2026-02-19"
  tasks-completed: 2
  tasks-total: 2
  findings: 9
  critical: 2
  high: 3
  medium: 3
  low: 1
---

# Phase 47 Plan v4.5-06: Network & Transport Layer Attacks Summary

**One-liner:** Comprehensive TLS census of 27 validation callbacks finding 2 unconditional bypasses remaining, plus 7 new protocol-specific findings across gRPC, MQTT, CoAP, and FTP transports.

## What Was Done

### Task 1: TLS & Certificate Attacks

Performed complete TLS security assessment across the entire codebase:

1. **TLS Bypass Census**: Identified all 27 TLS certificate validation callback locations. Classified each as UNCONDITIONAL BYPASS (2), CONFIGURABLE with secure default (18), CONDITIONAL (1), or SECURE (6).

2. **TLS Version Downgrade**: Confirmed TLS 1.2+ minimum enforcement where explicitly set (TcpP2PNetwork, QuantumSafeConnection, DatabaseProtocolBase). All HttpClient-based strategies rely on .NET 8 OS defaults (secure but not explicit).

3. **Cipher Suite Analysis**: No `CipherSuitesPolicy` found anywhere -- relies entirely on OS defaults (acceptable for .NET 8+).

4. **Certificate Pinning**: Only implemented in TcpP2PNetwork via thumbprint-based pinning. All other strategies use standard CA validation.

5. **mTLS Assessment**: mTLS implemented in TcpP2PNetwork, GrpcStorageStrategy (broken), FederationSystem, MtlsStrategy, DatabaseProtocolBase. Not universally enforced.

6. **Regression Tracking**: v4.3 had 15 unconditional bypasses -> v4.4 fixed 13 -> v4.5 still has 2 (GrpcStorageStrategy, FtpTransitStrategy).

### Task 2: Application Protocol Attacks

Tested all 6 application protocols:

1. **QUIC/HTTP3**: Configurable TLS with secure defaults. No QUIC-specific vulnerabilities found.
2. **gRPC**: Control plane uses `ChannelCredentials.Insecure` (FINDING-07). Storage strategy has unconditional TLS bypass (FINDING-06) and 100MB message size default (FINDING-14).
3. **MQTT**: No topic-level authorization in the codebase (FINDING-10). Authentication is connection-level only.
4. **WebSocket**: No Origin validation on control plane (FINDING-11). Client-side only.
5. **GraphQL**: Introspection enabled by default, no depth/complexity limiting (FINDING-12).
6. **CoAP**: DTLS completely unimplemented despite `coaps://` scheme support (FINDING-13).

## Findings Summary

| ID | Title | CVSS | Protocol |
|----|-------|------|----------|
| FINDING-06 | GrpcStorageStrategy unconditional TLS bypass | 9.1 Critical | gRPC/TLS |
| FINDING-07 | GrpcControlPlane hardcoded insecure credentials | 8.7 Critical | gRPC |
| FINDING-08 | FtpTransitStrategy unconditional cert bypass | 7.4 High | FTPS |
| FINDING-09 | AwsCloudHsmStrategy cert validation fallback | 6.5 Medium | HTTPS/TLS |
| FINDING-10 | MQTT control plane lacks topic authorization | 7.5 High | MQTT |
| FINDING-11 | WebSocket control plane missing Origin validation | 6.1 Medium | WebSocket |
| FINDING-12 | GraphQL introspection enabled, no depth limiting | 5.3 Medium | GraphQL |
| FINDING-13 | CoAP client has no DTLS security | 7.5 High | CoAP/UDP |
| FINDING-14 | gRPC Storage 100MB default message size | 3.1 Low | gRPC |

## Deviations from Plan

None -- plan executed exactly as written.

## Self-Check: PASSED
- [x] v4.5-06-NETWORK-FINDINGS.md exists and contains all 12 attack vectors
- [x] Complete TLS census (27 callbacks classified)
- [x] All application protocols assessed (gRPC, MQTT, WebSocket, QUIC, REST, GraphQL, CoAP)
- [x] v4.3 regression tracked (was 15, now 2)
- [x] All findings include CVSS scores and attack narratives
- [x] Commit 5832d3e2 exists
