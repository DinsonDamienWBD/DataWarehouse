---
phase: 50.1-feature-gap-closure
plan: 05
type: execute
wave: 1  # Waves are execution scheduling groups (max 2-3 concurrent), not dependency markers
depends_on: []
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateRAID/Strategies/Standard/StandardRaidStrategies.cs
  - Plugins/DataWarehouse.Plugins.UltimateRAID/Strategies/Standard/StandardRaidStrategiesB1.cs
autonomous: true
must_haves:
  truths:
    - "RAID 0/1/5/6/10 strategies have config validation for disk count, stripe size, parity"
    - "All RAID strategies have cached health checks monitoring array state"
    - "All RAID strategies have shutdown logic for flushing pending I/O"
    - "All RAID strategies have strategy-specific counters"
    - "No simulation stubs remain (Task.CompletedTask, new byte[length] patterns replaced)"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateRAID/Strategies/Standard/StandardRaidStrategies.cs"
      provides: "RAID 0/1/5/6/10 strategies with production infrastructure"
      contains: "InitializeAsyncCore"
    - path: "Plugins/DataWarehouse.Plugins.UltimateRAID/Strategies/Standard/StandardRaidStrategiesB1.cs"
      provides: "RAID standard strategies batch 1 with production infrastructure"
      contains: "InitializeAsyncCore"
  key_links:
    - from: "RAID strategies"
      to: "StrategyBase"
      via: "InitializeAsyncCore, GetCachedHealthAsync, IncrementCounter"
      pattern: "InitializeAsyncCore|GetCachedHealthAsync"
---

<objective>
Add production readiness infrastructure to RAID 0, RAID 1, RAID 5, RAID 6, and RAID 10 strategies.

Purpose: Push Domain 02 RAID features from 90% to 100%. Phase 44 audit flagged simulation stubs in StandardRaidStrategies.cs (Task.CompletedTask, new byte[length]) — these must also be addressed.

Output: RAID strategy files updated with production infrastructure, simulation stubs replaced.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/50.1-feature-gap-closure-push-all-80-99-features-to-100-production-readiness/50.1-RESEARCH.md

Phase 44 audit finding: StandardRaidStrategies.cs lines 152-162 have simulation stubs — `Task.CompletedTask` and `new byte[length]` where real I/O should happen. These must be replaced with proper implementations that delegate actual I/O to the configured storage backends via message bus or direct StorageAddress calls.

RAID strategies likely hold multiple disk strategies or references to storage providers. Check the class structure before modifying.
</context>

<tasks>

<task type="auto">
  <name>Task 1: Production-harden RAID 0/1/5/6/10 strategies and remove simulation stubs</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateRAID/Strategies/Standard/StandardRaidStrategies.cs
    Plugins/DataWarehouse.Plugins.UltimateRAID/Strategies/Standard/StandardRaidStrategiesB1.cs
  </files>
  <action>
FIRST: Read both files completely to understand the class structure, which RAID levels are in which file, and where the simulation stubs are.

For each RAID strategy class found:

1. **Replace simulation stubs**: Find all `Task.CompletedTask` returns and `new byte[length]` allocations in I/O paths. Replace with:
   - For read operations: delegate to configured storage backends, distribute reads across stripe members (RAID 0), mirror members (RAID 1), or parity groups (RAID 5/6)
   - For write operations: calculate stripe/mirror placement, write to appropriate members
   - If the strategy cannot perform real I/O without external disk references, implement proper delegation via the storage provider pattern: accept storage backends through configuration, validate they exist in InitializeAsyncCore, and call their read/write methods
   - If true I/O delegation is not feasible without major architectural changes, replace stubs with `throw new NotSupportedException("Requires configured storage backends. Use RAID plugin configuration to assign member disks.")` — this is better than silent stubs per Rule 13

2. **InitializeAsyncCore override**: Validate: minimum disk count (RAID 0: >=2, RAID 1: >=2, RAID 5: >=3, RAID 6: >=4, RAID 10: >=4 and even), stripe size (4KB-1MB, power of 2), rebuild priority (low/medium/high).

3. **Health check**: `CheckHealthAsync` using `GetCachedHealthAsync()`. Report array state: healthy (all members online), degraded (missing 1 within tolerance), critical (below minimum). 60-second cache.

4. **ShutdownAsyncCore**: Flush pending writes, cancel rebuild operations with timeout, dispose resources.

5. **Strategy-specific counters**: `IncrementCounter("raid0.read")`, `IncrementCounter("raid0.write")`, `IncrementCounter("raid5.parity_compute")`, etc.

6. **Edge case guards**: Zero-length read/write, offset beyond array capacity, write during rebuild state handling.
  </action>
  <verify>
`dotnet build DataWarehouse.slnx --no-restore 2>&1 | tail -5` — 0 errors 0 warnings.
Grep for "Task.CompletedTask" in RAID strategies — should return 0 matches (stubs removed).
Grep for "new byte\[" in I/O paths — confirm these are legitimate allocations, not simulation stubs.
  </verify>
  <done>All 5 RAID levels (0,1,5,6,10) have config validation, health checks, shutdown, counters. Simulation stubs replaced. Build passes.</done>
</task>

</tasks>

<verification>
1. `dotnet build DataWarehouse.slnx --no-restore` passes with 0 errors, 0 warnings
2. No `Task.CompletedTask` simulation stubs remain in RAID strategies
3. All RAID strategies have production infrastructure
4. Domain 02 (storage + RAID) fully at 100%
</verification>

<success_criteria>
RAID 0/1/5/6/10 strategies pushed to 100% with simulation stubs eliminated. Zero build errors. Domain 02 complete.
</success_criteria>

<output>
After completion, create `.planning/phases/50.1-feature-gap-closure-push-all-80-99-features-to-100-production-readiness/50.1-05-SUMMARY.md`
</output>
