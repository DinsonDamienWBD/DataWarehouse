---
phase: 50.1-feature-gap-closure
plan: 09
type: execute
wave: 3
depends_on: []
files_modified:
  - Plugins/DataWarehouse.Plugins.AirGapBridge/Strategies/TransferManifestStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateCompute/Strategies/
  - Plugins/DataWarehouse.Plugins.AdaptiveTransport/Strategies/
  - Plugins/DataWarehouse.Plugins.UltimateIntelligence/Strategies/
autonomous: true
must_haves:
  truths:
    - "AirGap transfer manifest strategy has config validation for checksums, manifest format"
    - "UltimateCompute 'Ultimate' feature has config validation and health checks"
    - "AdaptiveTransport 'Adaptive' feature has config validation and health checks"
    - "UltimateIntelligence 'Ultimate' feature has config validation and health checks"
    - "All strategies have shutdown, counters, error boundaries"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.AirGapBridge/"
      provides: "Air-gap transfer manifest with production infrastructure"
      contains: "InitializeAsyncCore"
    - path: "Plugins/DataWarehouse.Plugins.UltimateCompute/"
      provides: "Compute strategies with production infrastructure"
      contains: "InitializeAsyncCore"
  key_links:
    - from: "Cross-domain strategies"
      to: "StrategyBase"
      via: "InitializeAsyncCore, GetCachedHealthAsync, IncrementCounter"
      pattern: "InitializeAsyncCore|GetCachedHealthAsync"
---

<objective>
Add production readiness infrastructure to cross-domain strategies: AirGap transfer manifest (Domain 09), UltimateCompute (Domain 11), AdaptiveTransport (Domain 12), and UltimateIntelligence (Domain 13).

Purpose: Push Domains 09, 11, 12, 13 features from 90% to 100%. These are single-feature domains where one key strategy needs hardening.

Output: 4+ strategy files updated with production infrastructure.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/phases/50.1-feature-gap-closure-push-all-80-99-features-to-100-production-readiness/50.1-RESEARCH.md

IMPORTANT — Feature identification:
- Domain 09 "Transfer manifest with checksums" (AirGapBridge) — locate manifest-related strategy file
- Domain 11 "Ultimate" (UltimateCompute) — vague name, likely the main compute orchestrator/strategy
- Domain 12 "Adaptive" (Unknown plugin) — likely AdaptiveTransport plugin
- Domain 13 "Ultimate" (UltimateIntelligence) — vague name, likely the main intelligence strategy

Locate the actual files:
```bash
find Plugins/DataWarehouse.Plugins.AirGapBridge -name "*.cs" -type f | head -20
find Plugins/DataWarehouse.Plugins.UltimateCompute/Strategies -name "*.cs" -type f | head -20
find Plugins/DataWarehouse.Plugins.AdaptiveTransport/Strategies -name "*.cs" -type f | head -20
find Plugins/DataWarehouse.Plugins.UltimateIntelligence/Strategies -name "*.cs" -type f | head -20
```
</context>

<tasks>

<task type="auto">
  <name>Task 1: Production-harden AirGap manifest and UltimateCompute strategies</name>
  <files>
    Plugins/DataWarehouse.Plugins.AirGapBridge/
    Plugins/DataWarehouse.Plugins.UltimateCompute/Strategies/
  </files>
  <action>
FIRST: Locate the strategy files:
```bash
find Plugins/DataWarehouse.Plugins.AirGapBridge -name "*.cs" | xargs grep -l "class.*Strategy\|class.*Manifest"
find Plugins/DataWarehouse.Plugins.UltimateCompute/Strategies -name "*.cs" -type f | head -20
```

For AirGap transfer manifest strategy:
1. **InitializeAsyncCore**: Validate checksum algorithm (SHA-256/SHA-512/BLAKE2b), manifest format (JSON/binary), max transfer size (1MB-1TB), staging directory path (must be writable). Throw InvalidOperationException for missing staging dir.
2. **Health check**: Verify staging directory accessible and has sufficient space. 60-second cache.
3. **ShutdownAsyncCore**: Flush pending manifests, clean up temp files in staging.
4. **Counters**: `IncrementCounter("airgap.manifest_create")`, `IncrementCounter("airgap.manifest_verify")`, `IncrementCounter("airgap.bytes_transferred")`.
5. **Error boundaries**: Handle staging directory full, checksum mismatch on verification, corrupted manifest.
6. **Edge cases**: Empty transfer set, single-file transfer optimization, manifest size limits.

For UltimateCompute main strategy (identify the primary strategy file):
1. **InitializeAsyncCore**: Validate max concurrent tasks, memory limit per task, execution timeout, runtime type (WASM/Container/Native). Throw ArgumentException for invalid values.
2. **Health check**: Check runtime availability, test minimal task execution. 60-second cache.
3. **ShutdownAsyncCore**: Cancel running tasks with timeout, release runtime resources.
4. **Counters**: `IncrementCounter("compute.task_submit")`, `IncrementCounter("compute.task_complete")`, `IncrementCounter("compute.task_fail")`.
5. **Error boundaries**: Handle OOM, timeout, sandbox escape detection.

DO NOT modify any transfer or compute logic.
  </action>
  <verify>
`dotnet build DataWarehouse.slnx --no-restore 2>&1 | tail -5` — 0 errors 0 warnings.
  </verify>
  <done>AirGap manifest and UltimateCompute strategies have full production infrastructure. Build passes.</done>
</task>

<task type="auto">
  <name>Task 2: Production-harden AdaptiveTransport and UltimateIntelligence strategies</name>
  <files>
    Plugins/DataWarehouse.Plugins.AdaptiveTransport/Strategies/
    Plugins/DataWarehouse.Plugins.UltimateIntelligence/Strategies/
  </files>
  <action>
FIRST: Locate the strategy files:
```bash
find Plugins/DataWarehouse.Plugins.AdaptiveTransport -name "*.cs" -type f | head -20
find Plugins/DataWarehouse.Plugins.UltimateIntelligence -name "*.cs" -type f | head -20
```

For AdaptiveTransport main strategy (identify the primary adaptive transport strategy):
1. **InitializeAsyncCore**: Validate transport protocols (TCP/UDP/QUIC/WebSocket), bandwidth estimation interval (100-10000ms), congestion algorithm (cubic/bbr/reno), max connections (1-1000). Throw ArgumentException for invalid values.
2. **Health check**: Check network interface availability. 60-second cache.
3. **ShutdownAsyncCore**: Close active connections gracefully, flush send buffers.
4. **Counters**: `IncrementCounter("transport.bytes_sent")`, `IncrementCounter("transport.bytes_received")`, `IncrementCounter("transport.protocol_switch")`.
5. **Error boundaries**: Handle network unreachable, connection reset, protocol negotiation failure.

For UltimateIntelligence main strategy (identify the primary intelligence strategy):
1. **InitializeAsyncCore**: Validate AI provider (OpenAI/Anthropic/local), model name, max tokens, temperature (0.0-2.0), timeout (1000-300000ms). Throw InvalidOperationException for missing API key/endpoint.
2. **Health check**: Test simple inference call (or check API reachability). 60-second cache.
3. **ShutdownAsyncCore**: Cancel pending inference requests, dispose HTTP clients.
4. **Counters**: `IncrementCounter("intelligence.inference")`, `IncrementCounter("intelligence.tokens_used")`.
5. **Error boundaries**: Handle API rate limits (429), model unavailable (503), context length exceeded.

DO NOT modify any transport or intelligence logic.
  </action>
  <verify>
`dotnet build DataWarehouse.slnx --no-restore 2>&1 | tail -5` — 0 errors 0 warnings.
  </verify>
  <done>AdaptiveTransport and UltimateIntelligence strategies have full production infrastructure. Build passes. Domains 09, 11, 12, 13 complete.</done>
</task>

</tasks>

<verification>
1. `dotnet build DataWarehouse.slnx --no-restore` passes with 0 errors, 0 warnings
2. All 4 cross-domain strategies have production infrastructure
3. Domains 09, 11, 12, 13 fully at 100%
</verification>

<success_criteria>
AirGap manifest, UltimateCompute, AdaptiveTransport, UltimateIntelligence features pushed to 100%. Zero build errors.
</success_criteria>

<output>
After completion, create `.planning/phases/50.1-feature-gap-closure-push-all-80-99-features-to-100-production-readiness/50.1-09-SUMMARY.md`
</output>
