---
phase: 18-plugin-cleanup
plan: 03
type: execute
wave: 3
depends_on: ["18-02"]
files_modified:
  - Metadata/TODO.md
  - Plugin Readme.txt
autonomous: true

must_haves:
  truths:
    - "No remaining source code references any deleted plugin namespace"
    - "No remaining csproj references any deleted plugin project"
    - "Solution builds cleanly with zero errors"
    - "T108 is marked complete in TODO.md"
    - "Plugin Readme.txt is updated or confirmed accurate post-cleanup"
  artifacts:
    - path: "Metadata/TODO.md"
      provides: "Updated task tracker with T108 marked complete"
      contains: "[x]"
    - path: "Plugin Readme.txt"
      provides: "Accurate plugin documentation reflecting current state"
  key_links:
    - from: "DataWarehouse.slnx"
      to: "Plugins/"
      via: "Every Project entry resolves to an existing directory"
      pattern: "Project Path.*Plugins"
    - from: "DataWarehouse.Kernel"
      to: "Plugins/"
      via: "No references to deleted plugin namespaces"
---

<objective>
Perform final reference scanning, documentation updates, and build verification to confirm the cleanup is complete with no orphaned references anywhere in the codebase.

Purpose: After bulk deletion (Plan 18-02), stale references could lurk in documentation, kernel code, SDK code, or configuration files. This plan performs exhaustive scanning to catch anything missed and updates documentation to reflect the cleanup.

Output: Clean codebase with zero references to deleted plugins, updated TODO.md, and verified build.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/18-plugin-cleanup/18-RESEARCH.md
@.planning/phases/18-plugin-cleanup/18-02-SUMMARY.md
@DataWarehouse.slnx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Scan for orphaned references to deleted plugins</name>
  <files></files>
  <action>
**Step 1: Scan all .cs files for deprecated plugin namespace references**

Use `rg` (ripgrep) or grep to search across the entire repository (excluding Plugins/ directories that are deleted, and .planning/ docs) for any `using DataWarehouse.Plugins.{DeprecatedName}` statements. The deprecated names to scan for are all 88 plugin names from the deletion list.

Search patterns (sample -- cover all 88):
- `DataWarehouse\.Plugins\.AccessLog[^a-zA-Z]`
- `DataWarehouse\.Plugins\.Alerting[^a-zA-Z]`
- `DataWarehouse\.Plugins\.Prometheus[^a-zA-Z]`
- etc.

A practical approach: search for `DataWarehouse.Plugins.` in all .cs and .csproj files outside of Plugins/, then filter results to see if any reference a deleted plugin name.

**Step 2: Scan all .csproj files for ProjectReference to deleted plugins**

Search all .csproj files for `<ProjectReference` entries pointing to any deleted plugin path. Expected result: zero matches.

**Step 3: Scan DataWarehouse.Kernel and DataWarehouse.SDK for references**

These are the core projects. Specifically grep them for any deprecated plugin namespace or assembly name. Expected: zero references (research confirmed this, but verify post-deletion).

**Step 4: Check for any bin/obj artifacts from deleted projects**

Look for any remaining bin/ or obj/ directories under the deleted plugin paths. If any exist (because git rm only removes tracked files), delete them manually.

**Step 5: Document findings**

If any orphaned references are found:
- Fix them (remove the using statement, remove the ProjectReference, etc.)
- Document what was fixed

If zero orphaned references found, document that the scan was clean.
  </action>
  <verify>
Run: `rg "DataWarehouse\.Plugins\.(AccessLog|Alerting|AlertingOps|Prometheus|Datadog|Docker|Kibana|Tableau|PowerBI)" --type cs --glob "!Plugins/" .` -- should return zero results (or only matches in Ultimate/Universal migration documentation files within their own plugin dirs, which is acceptable).
Run: `dotnet build DataWarehouse.slnx` -- must pass with zero errors.
  </verify>
  <done>Zero orphaned references to deleted plugins found in production code. Any stale references discovered during scan have been fixed. Build passes cleanly.</done>
</task>

<task type="auto">
  <name>Task 2: Update documentation and mark T108 complete</name>
  <files>Metadata/TODO.md, Plugin Readme.txt</files>
  <action>
**Step 1: Mark T108 complete in TODO.md**

Read Metadata/TODO.md. Find the T108 entry (Plugin deprecation and cleanup task). Change its status from `[ ]` to `[x]` and add a completion note indicating Phase 18 execution removed 88 deprecated plugins.

If T108 has sub-tasks, mark them all complete:
- T108.1: Identify deprecated plugins -> [x]
- T108.2: Remove from slnx -> [x]
- T108.3: Delete files -> [x]
- T108.4: Verify clean build -> [x]

**Step 2: Review and update Plugin Readme.txt**

Read `Plugin Readme.txt` (in the solution root, referenced in slnx). Review its content:
- If it lists deprecated plugins that no longer exist, update the list to only include current plugins
- If it describes the plugin architecture, ensure descriptions are still accurate post-cleanup
- If it is a minimal/placeholder file, leave it as-is

**Step 3: Final build verification**

Run `dotnet clean DataWarehouse.slnx` followed by `dotnet build DataWarehouse.slnx` as a complete clean build to ensure no stale artifacts cause issues.

**Step 4: Generate post-cleanup metrics**

Count and report:
- Plugin directories remaining: (should be 57)
- Plugin entries in slnx: (should be 55)
- Files deleted in this phase: (sum from git status)
- Build status: pass/fail
  </action>
  <verify>
Run: `dotnet clean DataWarehouse.slnx && dotnet build DataWarehouse.slnx` -- must pass with zero errors.
Grep TODO.md for T108 -- should show `[x]`.
  </verify>
  <done>T108 marked complete in TODO.md. Plugin Readme.txt reviewed and updated if needed. Clean build passes. Post-cleanup metrics documented in summary.</done>
</task>

</tasks>

<verification>
- `dotnet clean && dotnet build DataWarehouse.slnx` passes with zero errors
- `rg "DataWarehouse.Plugins.(AccessLog|Prometheus|Docker|Kibana)" --type cs` returns zero results outside Ultimate/Universal migration docs
- T108 is marked [x] in Metadata/TODO.md
- Plugin directory count is 57
- slnx plugin entry count is 55
</verification>

<success_criteria>
Zero orphaned references to deleted plugins in the codebase. T108 marked complete. Solution builds cleanly from a clean state. The repository is in a consistent state with 57 plugin directories and 55 slnx plugin entries.
</success_criteria>

<output>
After completion, create `.planning/phases/18-plugin-cleanup/18-03-SUMMARY.md`
</output>
