---
phase: 65-infrastructure
plan: 15
type: execute
wave: 2
depends_on: ["65-14"]
files_modified:
  - DataWarehouse.Dashboard/Pages/SystemOverview.razor
  - DataWarehouse.Dashboard/Pages/PluginManager.razor
  - DataWarehouse.Dashboard/Pages/QueryExplorer.razor
  - DataWarehouse.Dashboard/Pages/SecurityDashboard.razor
  - DataWarehouse.Dashboard/Pages/ClusterStatus.razor
  - DataWarehouse.Dashboard/Services/DashboardApiClient.cs
autonomous: true

must_haves:
  truths:
    - "Web console shows system overview with plugin status, health, and metrics"
    - "Plugin manager page allows viewing and configuring plugins"
    - "Query explorer page allows running SQL queries with result display"
    - "Security dashboard shows recent events, SIEM status, and incident history"
    - "Cluster status shows node topology, Raft leader, and replication status"
  artifacts:
    - path: "DataWarehouse.Dashboard/Pages/SystemOverview.razor"
      provides: "System health overview page"
      min_lines: 80
    - path: "DataWarehouse.Dashboard/Pages/PluginManager.razor"
      provides: "Plugin list with status and configuration"
      min_lines: 80
    - path: "DataWarehouse.Dashboard/Pages/QueryExplorer.razor"
      provides: "SQL query editor and result viewer"
      min_lines: 100
    - path: "DataWarehouse.Dashboard/Services/DashboardApiClient.cs"
      provides: "HTTP client for Launcher API"
      min_lines: 100
  key_links:
    - from: "DashboardApiClient"
      to: "Launcher HTTP API"
      via: "HTTP REST calls"
      pattern: "HttpClient.*api/v1"
    - from: "SystemOverview.razor"
      to: "DashboardApiClient"
      via: "data fetching"
      pattern: "DashboardApiClient|GetAsync"
---

<objective>
Build the web management console (Blazor Server) with pages for system overview, plugin management, query exploration, security, and cluster status.

Purpose: DataWarehouse.Dashboard project exists but needs functional pages. The web console is the primary management interface for Tier 3+ deployments (Enterprise/Regulated/Hyperscale). It connects to the Launcher HTTP API (built in Phase 31) for data.

Output: 5 Blazor pages + DashboardApiClient in DataWarehouse.Dashboard/.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@DataWarehouse.Dashboard/Program.cs
@.planning/phases/65-infrastructure/65-14-SUMMARY.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Dashboard API client and system overview page</name>
  <files>
    DataWarehouse.Dashboard/Services/DashboardApiClient.cs
    DataWarehouse.Dashboard/Pages/SystemOverview.razor
    DataWarehouse.Dashboard/Pages/ClusterStatus.razor
  </files>
  <action>
Create DashboardApiClient.cs:
- Inject HttpClient configured with Launcher base URL (from configuration)
- Methods (all async, all with CancellationToken):
  - GetSystemStatusAsync() -> SystemStatus (uptime, version, node count, plugin count, health)
  - GetPluginsAsync() -> IReadOnlyList<PluginInfo> (id, name, version, status, health, strategy count)
  - GetPluginDetailAsync(string pluginId) -> PluginDetail (full info + strategies + configuration)
  - ExecuteQueryAsync(string sql) -> QueryResultDto (columns, rows, execution time, plan)
  - GetSecurityEventsAsync(int count = 50) -> IReadOnlyList<SecurityEventDto>
  - GetClusterStatusAsync() -> ClusterStatusDto (nodes, leader, term, replication status)
  - GetMetricsAsync() -> MetricsDto (CPU, memory, disk, request rate)
- All DTOs as records with System.Text.Json deserialization
- Error handling: HttpRequestException -> user-friendly error message
- Authentication: Bearer token from session (if auth enabled)

Create SystemOverview.razor:
- Top stats cards: Uptime, Plugins Active, Nodes Online, Storage Used, Requests/sec
- Health status indicator (Healthy/Degraded/Unhealthy) with color coding
- Plugin status summary table: Name, Version, Health, Strategy Count (sortable)
- Recent events list (last 10 security/system events)
- Auto-refresh every 10 seconds via PeriodicTimer + StateHasChanged

Create ClusterStatus.razor:
- Node topology diagram: list of nodes with role (Leader/Follower/Candidate), health, last heartbeat
- Raft status: current term, leader ID, log index, commit index
- Replication status: per-node replication lag
- CRDT sync status: merge count, pending merges
- SWIM membership: member count, suspect count, last gossip round
- Auto-refresh every 5 seconds
  </action>
  <verify>dotnet build DataWarehouse.Dashboard/DataWarehouse.Dashboard.csproj — zero errors</verify>
  <done>DashboardApiClient connects to Launcher HTTP API; SystemOverview shows health and metrics; ClusterStatus shows distributed system state</done>
</task>

<task type="auto">
  <name>Task 2: Plugin manager, query explorer, and security dashboard</name>
  <files>
    DataWarehouse.Dashboard/Pages/PluginManager.razor
    DataWarehouse.Dashboard/Pages/QueryExplorer.razor
    DataWarehouse.Dashboard/Pages/SecurityDashboard.razor
  </files>
  <action>
Create PluginManager.razor:
- Plugin list with search/filter (by category, health status)
- Plugin detail panel: click plugin -> shows full info, strategy list, configuration
- Strategy list: name, description, is active, performance stats
- Configuration panel: display current plugin configuration as key-value pairs
- Capability browser: list registered capabilities per plugin
- Health history: mini chart showing health status over last hour (if data available from API)

Create QueryExplorer.razor:
- SQL editor textarea with monospace font, line numbers (CSS-based)
- Execute button (Ctrl+Enter shortcut via JS interop)
- Results table: dynamic columns from query result schema, scrollable
- Query plan viewer: EXPLAIN output displayed as formatted text or tree
- Execution stats: rows returned, time, bytes scanned
- Query history: last 20 queries stored in browser localStorage (via JSInterop)
- Error display: SQL parse errors shown with line/column highlighting

Create SecurityDashboard.razor:
- Security score display (current score out of 100)
- Recent security events table: timestamp, severity (color-coded), source, description
- SIEM transport status: connected/disconnected per configured transport
- Incident response: active incidents list with status (Open/Contained/Resolved)
- Vulnerability scan results: last scan date, findings summary (Critical/High/Medium/Low)
- Access control summary: active sessions, failed auth attempts (last hour)
- Auto-refresh every 15 seconds

All pages:
- Use Blazor Server components (not WASM — server-side rendering for admin console)
- Responsive layout: works on desktop and tablet
- Error boundaries: if API call fails, show inline error message (not crash)
- Loading states: show spinner while data loads
  </action>
  <verify>dotnet build DataWarehouse.Dashboard/DataWarehouse.Dashboard.csproj — zero errors</verify>
  <done>PluginManager shows plugin details and configuration; QueryExplorer runs SQL with results; SecurityDashboard shows events, SIEM status, incidents</done>
</task>

</tasks>

<verification>
- Dashboard project builds with zero errors
- 5 Blazor pages exist with functional layouts
- DashboardApiClient has methods for all dashboard data needs
</verification>

<success_criteria>
Web management console has 5 functional pages (SystemOverview, ClusterStatus, PluginManager, QueryExplorer, SecurityDashboard) connecting to Launcher HTTP API.
</success_criteria>

<output>
After completion, create `.planning/phases/65-infrastructure/65-15-SUMMARY.md`
</output>
