---
phase: 03-security-infrastructure
plan: 04
type: execute
wave: 2
depends_on: ["03-03"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/*.cs
  - Metadata/TODO.md
autonomous: true

must_haves:
  truths:
    - "All 10 identity strategies authenticate users via their respective protocols"
    - "Identity strategies degrade gracefully when external services are unavailable (IsAvailableAsync returns false)"
    - "All 10 identity strategy classes compile with zero forbidden patterns"
    - "T95 B3 items in TODO.md are marked [x]"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/"
      provides: "10 identity provider strategy implementations"
  key_links:
    - from: "Identity strategies"
      to: "UltimateAccessControlPlugin orchestrator"
      via: "IAccessControlStrategy auto-discovery"
      pattern: "IIdentityStrategy|IAccessControlStrategy"
---

<objective>
Implement all 10 identity strategies (T95.B3) for UltimateAccessControl.

Purpose: Identity providers are the authentication layer. This plan implements IAM, LDAP, OAuth2, OIDC, SAML, Kerberos, RADIUS, TACACS+, SCIM, FIDO2 identity providers.
Output: 10 identity strategy implementations.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-security-infrastructure/03-RESEARCH.md
@Metadata/CLAUDE.md
@.planning/phases/03-security-infrastructure/03-03-SUMMARY.md
@Plugins/DataWarehouse.Plugins.UltimateAccessControl/IAccessControlStrategy.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement 10 identity strategies (T95.B3)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/IamStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/LdapStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/OAuth2Strategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/OidcStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/SamlStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/KerberosStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/RadiusStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/TacacsStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/ScimStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Identity/Fido2Strategy.cs
  </files>
  <action>
CRITICAL WORKFLOW RULES:
- Rule 13: No simulations, mocks, stubs, placeholders -- everything production-ready
- Plugin isolation: plugins reference ONLY SDK via ProjectReference
- All communication via message bus (no direct plugin references)
- Base classes mandatory: use appropriate strategy base class
- Verify before implementing: check if FederatedIdentityStrategy.cs already covers some

1. First check what exists: FederatedIdentityStrategy.cs is in Core/ -- read it to see if it covers OAuth2/OIDC/SAML.

2. Create Strategies/Identity/ directory if it does not exist.

3. Implement each strategy. All must:
   - Implement IAccessControlStrategy (or IIdentityStrategy if defined in SDK)
   - Have StrategyId matching the pattern (e.g., "identity-oauth2")
   - Include IsAvailableAsync() to detect if the protocol's infrastructure is reachable
   - Provide real protocol integration (not stubs)
   - Handle timeouts and connection failures gracefully
   - Include XML documentation

   **B3.1 IamStrategy** - Generic IAM framework with configurable user/role stores
   **B3.2 LdapStrategy** - LDAP/Active Directory using System.DirectoryServices.Protocols
   **B3.3 OAuth2Strategy** - OAuth 2.0 token validation (see research code example)
   **B3.4 OidcStrategy** - OpenID Connect discovery + token validation
   **B3.5 SamlStrategy** - SAML 2.0 assertion parsing and validation
   **B3.6 KerberosStrategy** - Kerberos ticket validation (SPNEGO/GSSAPI)
   **B3.7 RadiusStrategy** - RADIUS authentication (Access-Request/Accept/Reject)
   **B3.8 TacacsStrategy** - TACACS+ authentication protocol
   **B3.9 ScimStrategy** - SCIM 2.0 user provisioning and identity sync
   **B3.10 Fido2Strategy** - FIDO2/WebAuthn credential verification

4. Build: `dotnet build` on UltimateAccessControl project.

5. Update Metadata/TODO.md:
   - Mark T95.B3.1 through B3.10 as [x]
  </action>
  <verify>
`dotnet build` succeeds. All 10 identity strategy .cs files exist in Strategies/Identity/.
No forbidden patterns (grep for NotImplementedException, simulation, mock, stub).
TODO.md T95.B3 items all marked [x].
  </verify>
  <done>
All 10 identity strategies (IAM, LDAP, OAuth2, OIDC, SAML, Kerberos, RADIUS, TACACS+, SCIM, FIDO2) implemented, compiling, and synced in TODO.md.
  </done>
</task>

</tasks>

<verification>
1. `dotnet build` succeeds for UltimateAccessControl project
2. 10 identity strategy files in Strategies/Identity/
3. No forbidden patterns in any strategy file
4. TODO.md B3 items all [x]
</verification>

<success_criteria>
- All 10 identity strategies are production-ready implementations
- Plugin builds cleanly
- TODO.md T95 B3 fully synced
</success_criteria>

<output>
After completion, create `.planning/phases/03-security-infrastructure/03-04-SUMMARY.md`
</output>
