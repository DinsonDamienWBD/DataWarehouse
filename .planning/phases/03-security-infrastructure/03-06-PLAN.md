---
phase: 03-security-infrastructure
plan: 06
type: execute
wave: 3
depends_on: ["03-04", "03-05"]
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/*.cs
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/*.cs
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/*.cs
  - Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/*.cs
  - Metadata/TODO.md
autonomous: true

must_haves:
  truths:
    - "All B8 integrity strategies verify data tamper-evidence"
    - "All B9 data protection strategies mask, tokenize, and anonymize data"
    - "All B10 military security strategies enforce classification levels"
    - "All B11 network security strategies implement firewall/WAF/IPS/DDoS/VPN/SD-WAN"
    - "T95 B8, B9, B10, B11 items in TODO.md are marked [x]"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/"
      provides: "7 integrity/tamper-proof strategies"
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/"
      provides: "7 data protection strategies"
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/"
      provides: "6 military/classified data strategies"
    - path: "Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/"
      provides: "6 network security strategies"
  key_links:
    - from: "Integrity strategies"
      to: "UltimateAccessControlPlugin orchestrator"
      via: "IAccessControlStrategy auto-discovery"
      pattern: "IAccessControlStrategy"
---

<objective>
Implement integrity/data protection strategies (T95.B8-B9), military security strategies (T95.B10), and network security strategies (T95.B11) for UltimateAccessControl.

Purpose: These strategies cover data-at-rest protection (integrity, masking, tokenization, anonymization), classified data handling (military clearance levels), and perimeter security (firewall, WAF, IPS, DDoS, VPN, SD-WAN).
Output: 26 strategy implementations.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/03-security-infrastructure/03-RESEARCH.md
@Metadata/CLAUDE.md
@.planning/phases/03-security-infrastructure/03-03-SUMMARY.md
@Plugins/DataWarehouse.Plugins.UltimateAccessControl/IAccessControlStrategy.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement integrity and data protection strategies (T95.B8, B9)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/IntegrityStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/TamperProofStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/MerkleTreeStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/BlockchainAnchorStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/TsaStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/WormStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/Integrity/ImmutableLedgerStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/EntropyAnalysisStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/DlpStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/DataMaskingStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/TokenizationStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/AnonymizationStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/PseudonymizationStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/DataProtection/DifferentialPrivacyStrategy.cs
  </files>
  <action>
CRITICAL WORKFLOW RULES:
- Rule 13: No simulations, mocks, stubs, placeholders
- Plugin isolation: SDK-only references, message bus for inter-plugin comms
- Base classes mandatory

1. Create Strategies/Integrity/ and Strategies/DataProtection/ directories.

2. Implement B8 Integrity strategies:

   **B8.1 IntegrityStrategy** - Data integrity verification using SHA-256/512 checksums
   **B8.2 TamperProofStrategy** - Tamper-evident storage with sealed hash chains
   **B8.3 MerkleTreeStrategy** - Merkle tree construction and proof verification
   **B8.4 BlockchainAnchorStrategy** - Timestamp anchoring to blockchain (hash commitment)
   **B8.5 TsaStrategy** - RFC 3161 Timestamping Authority requests and verification
   **B8.6 WormStrategy** - Write-Once-Read-Many enforcement with retention policies
   **B8.7 ImmutableLedgerStrategy** - Append-only audit ledger with cryptographic linking

3. Implement B9 Data Protection strategies:

   **B9.1 EntropyAnalysisStrategy** - Entropy/randomness analysis to detect encrypted vs plaintext data
   **B9.2 DlpStrategy** - Data Loss Prevention with content inspection rules, regex patterns, keyword matching
   **B9.3 DataMaskingStrategy** - Dynamic masking (show last 4 digits, mask emails, etc.)
   **B9.4 TokenizationStrategy** - Replace sensitive data with tokens, maintain token vault
   **B9.5 AnonymizationStrategy** - K-anonymity, L-diversity implementations
   **B9.6 PseudonymizationStrategy** - Reversible pseudonymization with key-based mapping
   **B9.7 DifferentialPrivacyStrategy** - Laplace/Gaussian noise injection with configurable epsilon

4. Build project.
  </action>
  <verify>
`dotnet build` succeeds. 14 strategy files exist in Integrity/ and DataProtection/.
  </verify>
  <done>
7 integrity + 7 data protection strategies implemented and compiling.
  </done>
</task>

<task type="auto">
  <name>Task 2: Implement military and network security strategies (T95.B10, B11) and sync TODO.md</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/MilitarySecurityStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/MlsStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/CdsStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/CuiStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/ItarStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/MilitarySecurity/SciStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/FirewallRulesStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/WafStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/IpsStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/DdosProtectionStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/VpnStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateAccessControl/Strategies/NetworkSecurity/SdWanStrategy.cs
    Metadata/TODO.md
  </files>
  <action>
1. Create Strategies/MilitarySecurity/ and Strategies/NetworkSecurity/ directories.

2. Implement B10 Military Security strategies:

   **B10.1 MilitarySecurityStrategy** - Classified data handling with security markings
   **B10.2 MlsStrategy** - Multi-Level Security: TS/S/C/U with cross-level read/write rules
   **B10.3 CdsStrategy** - Cross-Domain Solutions: controlled data transfer between classification levels
   **B10.4 CuiStrategy** - Controlled Unclassified Information: CUI marking, handling, dissemination controls
   **B10.5 ItarStrategy** - ITAR compliance: export controls, foreign person restrictions
   **B10.6 SciStrategy** - Sensitive Compartmented Information: compartment-based access, need-to-know enforcement

3. Implement B11 Network Security strategies:

   **B11.1 FirewallRulesStrategy** - IP/port-based rule management, allow/deny lists
   **B11.2 WafStrategy** - Web Application Firewall: OWASP Top 10 rule sets, SQL injection/XSS detection
   **B11.3 IpsStrategy** - Intrusion Prevention: signature-based detection, anomaly-based detection
   **B11.4 DdosProtectionStrategy** - Rate limiting, connection throttling, SYN flood detection
   **B11.5 VpnStrategy** - VPN tunnel management, IPSec/WireGuard config, split tunneling policies
   **B11.6 SdWanStrategy** - SD-WAN security policies, traffic encryption, branch isolation

4. Build project.

5. Update Metadata/TODO.md:
   - Mark T95.B8.1-B8.7 as [x] (lines ~8142-8148)
   - Mark T95.B9.1-B9.7 as [x] (lines ~8150-8156)
   - Mark T95.B10.1-B10.6 as [x] (lines ~8158-8163)
   - Mark T95.B11.1-B11.6 as [x] (lines ~8165-8170)
  </action>
  <verify>
`dotnet build` succeeds. 12 strategy files exist in MilitarySecurity/ and NetworkSecurity/.
TODO.md B8-B11 items all marked [x].
  </verify>
  <done>
6 military + 6 network security strategies implemented and compiling.
T95 B8 (7), B9 (7), B10 (6), B11 (6) = 26 items marked [x] in TODO.md.
  </done>
</task>

</tasks>

<verification>
1. `dotnet build` succeeds for UltimateAccessControl project
2. Strategy directories created: Integrity/, DataProtection/, MilitarySecurity/, NetworkSecurity/
3. 26 total strategy files across all 4 directories
4. TODO.md B8-B11 items all [x]
</verification>

<success_criteria>
- All 26 strategies are production-ready with no forbidden patterns
- Plugin builds cleanly
- TODO.md T95 B8-B11 fully synced
</success_criteria>

<output>
After completion, create `.planning/phases/03-security-infrastructure/03-06-SUMMARY.md`
</output>
