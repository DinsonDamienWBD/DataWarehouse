---
phase: 65.3-strategy-aware-plugin-base-infrastructure
plan: 05
type: execute
wave: 1
depends_on: []
files_modified:
  - Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/IoTStrategyBase.cs
  - Plugins/DataWarehouse.Plugins.UltimateIntelligence/IntelligenceStrategyBase.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataManagement/DataManagementStrategyBase.cs
  - Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/DatabaseProtocolStrategyBase.cs
  - Plugins/DataWarehouse.Plugins.UltimateIntelligence/DomainModels/DomainModelRegistry.cs
  - Plugins/DataWarehouse.Plugins.UltimateIntelligence/Strategies/Memory/Regeneration/IAdvancedRegenerationStrategy.cs
  - Plugins/DataWarehouse.Plugins.UltimateDataManagement/FanOut/IFanOutStrategy.cs
autonomous: true

must_haves:
  truths:
    - "IoTStrategyBase, IntelligenceStrategyBase, DataManagementStrategyBase, DatabaseProtocolStrategyBase extend StrategyBase"
    - "DomainModelStrategyBase, RegenerationStrategyBase, FanOutStrategyBase extend StrategyBase"
    - "All sub-bases that inherit from these root bases (e.g., ProtocolStrategyBase : IoTStrategyBase) continue to compile"
    - "All concrete strategies in these plugin trees compile without changes"
  artifacts:
    - path: "Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/IoTStrategyBase.cs"
      provides: "IoTStrategyBase extending StrategyBase"
      contains: "IoTStrategyBase : StrategyBase"
    - path: "Plugins/DataWarehouse.Plugins.UltimateIntelligence/IntelligenceStrategyBase.cs"
      provides: "IntelligenceStrategyBase extending StrategyBase"
      contains: "IntelligenceStrategyBase : StrategyBase"
    - path: "Plugins/DataWarehouse.Plugins.UltimateDataManagement/DataManagementStrategyBase.cs"
      provides: "DataManagementStrategyBase extending StrategyBase"
      contains: "DataManagementStrategyBase : StrategyBase"
  key_links:
    - from: "All 7 strategy bases in this plan"
      to: "DataWarehouse.SDK/Contracts/StrategyBase.cs"
      via: "class inheritance"
      pattern: ": StrategyBase"
---

<objective>
Migrate 7 more Tier 2 plugin-local strategy bases (including those that serve as roots for sub-hierarchies) to extend SDK StrategyBase.

Purpose: These are the remaining Tier 2 bases, several of which are hierarchy roots (IoTStrategyBase has 7 sub-bases, DataManagementStrategyBase has 8 sub-bases, IntelligenceStrategyBase has 4 sub-bases). Migrating these roots automatically brings their sub-bases into the StrategyBase hierarchy.

Output: 7 modified strategy base files, all extending StrategyBase. ~20 sub-bases inherit StrategyBase transitively.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@DataWarehouse.SDK/Contracts/StrategyBase.cs
@DataWarehouse.SDK/Contracts/IStrategy.cs
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate hierarchy-root strategy bases (IoT, Intelligence, DataManagement, DatabaseProtocol)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/IoTStrategyBase.cs
    Plugins/DataWarehouse.Plugins.UltimateIntelligence/IntelligenceStrategyBase.cs
    Plugins/DataWarehouse.Plugins.UltimateDataManagement/DataManagementStrategyBase.cs
    Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/DatabaseProtocolStrategyBase.cs
  </files>
  <action>
These 4 bases are hierarchy roots with sub-bases inheriting from them. Migrating the root automatically migrates the entire sub-tree.

Apply the same migration pattern from Plan 04:

1. Change `class XxxStrategyBase : IXxxStrategy` to `class XxxStrategyBase : StrategyBase, IXxxStrategy`
2. Remove duplicated members (counters, init, health, dispose)
3. Map name properties (StrategyId -> override, Name/DisplayName)
4. Preserve all domain-specific members
5. Handle IDisposable/IAsyncDisposable conflicts

**IoTStrategyBase** (`IoTStrategyBase : IIoTStrategyBase`):
- Root for ProtocolStrategyBase, DeviceManagementStrategyBase, SensorIngestionStrategyBase, EdgeIntegrationStrategyBase, IoTSecurityStrategyBase, ProvisioningStrategyBase, HardwareBusStrategyBase, IoTAnalyticsStrategyBase, DataTransformationStrategyBase (IoT)
- After migration, ALL of these sub-bases inherit StrategyBase transitively
- Build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/ --no-restore`

**IntelligenceStrategyBase** (`IntelligenceStrategyBase : IIntelligenceStrategy`):
- Root for AIProviderStrategyBase, VectorStoreStrategyBase, KnowledgeGraphStrategyBase, FeatureStrategyBase, TabularModelStrategyBase, LongTermMemoryStrategyBase
- All in the same plugin project
- Build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateIntelligence/ --no-restore`

**DataManagementStrategyBase** (`DataManagementStrategyBase : StrategyBase, IDataManagementStrategy`):
- WAIT -- this one ALREADY extends StrategyBase! Check the grep output. Yes: `DataManagementStrategyBase : StrategyBase, IDataManagementStrategy`. So this is already migrated.
- Skip this file. But verify sub-bases (VersioningStrategyBase, TieringStrategyBase, etc.) are correct.

**DatabaseProtocolStrategyBase** (`DatabaseProtocolStrategyBase : IDatabaseProtocolStrategy, IDisposable, IAsyncDisposable`):
- Standalone -- no sub-bases
- Has its own IDisposable, IAsyncDisposable -- remove from declaration (inherited from StrategyBase)
- Build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/ --no-restore`

For each, build the plugin project after modification to catch compilation errors immediately. Fix errors before moving to the next file.

IMPORTANT for hierarchy roots: After modifying the root, ALL sub-bases in the same plugin must still compile. The sub-bases may have their own members that now conflict with StrategyBase. Check for:
- `StrategyId` property (should become `override`)
- `Name` property (should become `override`)
- `Dispose()` method (should become `protected override void Dispose(bool disposing)`)
- `_initialized` field (may shadow the inherited one -- remove and use inherited)
  </action>
  <verify>
Build all 3 plugin projects (IoT, Intelligence, DatabaseProtocol):
```
dotnet build Plugins/DataWarehouse.Plugins.UltimateIoTIntegration/ --no-restore
dotnet build Plugins/DataWarehouse.Plugins.UltimateIntelligence/ --no-restore
dotnet build Plugins/DataWarehouse.Plugins.UltimateDatabaseProtocol/ --no-restore
```
All produce 0 errors, 0 warnings.
  </verify>
  <done>IoTStrategyBase, IntelligenceStrategyBase, DatabaseProtocolStrategyBase extend StrategyBase. DataManagementStrategyBase already does. All sub-bases compile transitively.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate remaining standalone bases (DomainModel, Regeneration, FanOut)</name>
  <files>
    Plugins/DataWarehouse.Plugins.UltimateIntelligence/DomainModels/DomainModelRegistry.cs
    Plugins/DataWarehouse.Plugins.UltimateIntelligence/Strategies/Memory/Regeneration/IAdvancedRegenerationStrategy.cs
    Plugins/DataWarehouse.Plugins.UltimateDataManagement/FanOut/IFanOutStrategy.cs
  </files>
  <action>
These 3 strategy bases are defined in files alongside their interfaces. Migrate only the base classes, not the interfaces.

**DomainModelStrategyBase** (in DomainModelRegistry.cs):
- `class DomainModelStrategyBase : IDomainModelStrategy`
- Change to `class DomainModelStrategyBase : StrategyBase, IDomainModelStrategy`
- Remove duplicated infrastructure
- Build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateIntelligence/ --no-restore`

**RegenerationStrategyBase** (in IAdvancedRegenerationStrategy.cs):
- `class RegenerationStrategyBase : IAdvancedRegenerationStrategy`
- Change to `class RegenerationStrategyBase : StrategyBase, IAdvancedRegenerationStrategy`
- Build: same as above (same plugin)

**FanOutStrategyBase** (in IFanOutStrategy.cs):
- `class FanOutStrategyBase : IFanOutStrategy`
- Change to `class FanOutStrategyBase : StrategyBase, IFanOutStrategy`
- Build: `dotnet build Plugins/DataWarehouse.Plugins.UltimateDataManagement/ --no-restore`

After all modifications, do a full solution build to verify no cross-project issues.
  </action>
  <verify>
```
dotnet build Plugins/DataWarehouse.Plugins.UltimateIntelligence/ --no-restore
dotnet build Plugins/DataWarehouse.Plugins.UltimateDataManagement/ --no-restore
dotnet build DataWarehouse.sln --no-restore
```
All produce 0 errors, 0 warnings.
  </verify>
  <done>DomainModelStrategyBase, RegenerationStrategyBase, FanOutStrategyBase extend StrategyBase. Full solution builds cleanly. Combined with Plan 04, all Tier 2 bases are migrated.</done>
</task>

</tasks>

<verification>
1. `dotnet build DataWarehouse.sln --no-restore` -- 0 errors, 0 warnings
2. Grep for `: StrategyBase` in all modified files confirms migration
3. Grep for `: IIoTStrategyBase` in IoT sub-bases -- they transitively inherit StrategyBase
4. Count of plugin-local strategy bases NOT extending StrategyBase should be 0 (verify with grep)
</verification>

<success_criteria>
- All 7 targeted strategy bases (minus DataManagementStrategyBase already done) extend StrategyBase
- Sub-base hierarchies (20+ sub-bases under IoT, Intelligence, DataManagement) compile transitively
- All concrete strategies compile without changes
- Full solution builds with 0 errors, 0 warnings
</success_criteria>

<output>
After completion, create `.planning/phases/65.3-strategy-aware-plugin-base-infrastructure/65.3-05-SUMMARY.md`
</output>
