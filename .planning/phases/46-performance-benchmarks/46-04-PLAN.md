---
phase: 46
plan: 46-04
title: "Network & Transport Performance"
depends_on: []
---

# Plan 46-04: Network & Transport Performance

## Goal
Benchmark network transport performance comparing gRPC vs REST vs GraphQL throughput. Measure adaptive transport switching behavior and AEDS data plane performance (HTTP/2 vs HTTP/3). Establish baseline metrics for client-server communication efficiency.

## Approach
1. **gRPC vs REST vs GraphQL Throughput**:
   - Deploy DataWarehouse server with all three API endpoints enabled
   - Execute identical queries via each protocol:
     - `GET /api/data/{id}` (REST)
     - `rpc GetData(id)` (gRPC)
     - `query { data(id) { ... } }` (GraphQL)
   - Payload sizes: 1KB, 10KB, 100KB, 1MB
   - Measure throughput (requests per second) and latency (ms)
   - Test scenarios: local (same machine), LAN (10ms RTT), WAN (100ms RTT simulated)
   - Repeat 1000 requests per protocol × size × scenario
2. **Adaptive Transport Switching**:
   - Configure adaptive transport with threshold: if latency >50ms, switch HTTP/2 → HTTP/3
   - Inject network latency: 10ms → 60ms → 10ms
   - Verify transport switch occurs (HTTP/2 → HTTP/3 at 60ms, HTTP/3 → HTTP/2 at 10ms)
   - Measure switch latency: detection → new protocol active
   - Verify zero dropped requests during switch
3. **AEDS Data Plane Performance**:
   - Deploy AEDS server (control plane + data plane)
   - Deploy AEDS client
   - Test HTTP/2 data plane: upload 100MB file, measure throughput
   - Test HTTP/3 data plane: upload 100MB file, measure throughput
   - Compare throughput under packet loss (0%, 1%, 5%)
   - Measure control plane latency: command issued → acknowledgment received
4. **Streaming Performance**:
   - gRPC server streaming: subscribe to data changes, measure push latency (write → client notified)
   - gRPC bidirectional streaming: concurrent read/write, measure throughput
   - GraphQL subscriptions: WebSocket-based updates, measure latency
5. **Connection Overhead**:
   - Measure connection establishment time: TCP handshake + TLS + protocol negotiation
   - Compare HTTP/2 vs HTTP/3 connection setup (gRPC and AEDS)
6. **Automation**:
   - Create benchmark harness: `dw benchmark network --protocols grpc,rest,graphql --sizes 1KB,10KB,100KB,1MB --scenarios local,lan,wan`

## Scope
**In Scope:**
- Protocols: gRPC, REST, GraphQL
- Payload sizes: 1KB, 10KB, 100KB, 1MB
- Network scenarios: local, LAN (10ms), WAN (100ms)
- Adaptive transport switching (HTTP/2 ↔ HTTP/3)
- AEDS data plane (HTTP/2 vs HTTP/3)
- Streaming (server-side, bidirectional, GraphQL subscriptions)
- Metrics: requests/sec, ms latency, MB/s throughput, connection setup time

**Out of Scope:**
- Data pipeline performance (Plan 46-01)
- Storage performance (Plan 46-02)
- Distributed systems performance (Plan 46-03)
- Real internet WAN (using simulated latency)

## Success Criteria
- [ ] gRPC, REST, GraphQL throughput measured for all sizes × scenarios (1000 requests each)
- [ ] Latency comparison documented (p50/p95/p99 per protocol)
- [ ] Adaptive transport switches HTTP/2 → HTTP/3 when latency >50ms
- [ ] Adaptive transport switches HTTP/3 → HTTP/2 when latency <50ms
- [ ] Zero requests dropped during transport switch
- [ ] AEDS HTTP/2 vs HTTP/3 throughput compared (100MB upload)
- [ ] AEDS throughput under packet loss documented (0%, 1%, 5%)
- [ ] gRPC streaming latency measured (write to client notification <100ms)
- [ ] GraphQL subscription latency measured (write to WebSocket push <200ms)
- [ ] Connection setup time documented (gRPC HTTP/2, gRPC HTTP/3, REST, GraphQL)
- [ ] Benchmark harness implemented and tested
- [ ] Results exported to CSV/JSON format

## Output
- `46-04-benchmark-results.csv`: Raw network performance data
- `46-04-network-analysis.md`: Summary, protocol comparison, recommendations
- `46-04-adaptive-transport-log.txt`: Transport switching timeline and validation
- `Tools/Benchmarks/NetworkBenchmark.cs`: Benchmark harness implementation
- Updated `.planning/phases/46-performance-benchmarks/STATUS.md` with results
