---
phase: 01-sdk-foundation-base-classes
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - DataWarehouse.SDK/Contracts/Security/SecurityStrategy.cs
  - Metadata/TODO.md
autonomous: true
must_haves:
  truths:
    - "ISecurityStrategy interface exists with EvaluateAsync method accepting SecurityContext and returning SecurityDecision"
    - "SecurityDomain enum covers all security domains (AccessControl, DataProtection, Network, Identity, Compliance, ThreatDetection, IntegrityVerification, ZeroTrust)"
    - "SecurityContext class has all required fields for security evaluation (UserId, ResourceId, Action, etc.)"
    - "SecurityDecision result type includes Allowed, Domain, Reason, PolicyId fields"
    - "ZeroTrust policy framework types exist (ZeroTrustPolicy, ZeroTrustEvaluation)"
    - "Threat detection abstractions exist (IThreatDetector, ThreatIndicator, ThreatSeverity)"
    - "Integrity verification framework exists (IIntegrityVerifier, IntegrityResult)"
  artifacts:
    - path: "DataWarehouse.SDK/Contracts/Security/SecurityStrategy.cs"
      provides: "Complete security SDK infrastructure including ISecurityStrategy, SecurityDomain, SecurityContext, SecurityDecision, ZeroTrust, threat detection, integrity verification"
      contains: "ISecurityStrategy"
  key_links:
    - from: "DataWarehouse.SDK/Contracts/Security/SecurityStrategy.cs"
      to: "DataWarehouse.SDK/Contracts/PluginBase.cs"
      via: "SecurityStrategyBase extends pattern from PluginBase"
      pattern: "SecurityStrategyBase"
---

<objective>
Verify and complete SDK security infrastructure (T95.A1-A8): ISecurityStrategy, SecurityDomain, SecurityContext, SecurityDecision, ZeroTrust, threat detection abstractions, and integrity verification framework.

Purpose: The security SDK infrastructure is the foundation for UltimateAccessControl (T95) plugin. All 8 Phase A sub-tasks must be verified as production-ready before the plugin can be built.

Output: Verified security SDK types with any gaps fixed, TODO.md updated for T95.A1-A7 items.
</objective>

<execution_context>
@C:/Users/ddamien/.claude/get-shit-done/workflows/execute-plan.md
@C:/Users/ddamien/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-sdk-foundation-base-classes/01-RESEARCH.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Verify T95.A1-A4 — ISecurityStrategy, SecurityDomain, SecurityContext, SecurityDecision</name>
  <files>
    DataWarehouse.SDK/Contracts/Security/SecurityStrategy.cs
    Metadata/TODO.md
  </files>
  <action>
    Read the full `SecurityStrategy.cs` file (29KB per research) and verify each T95 Phase A sub-task:

    **T95.A1 — ISecurityStrategy interface:**
    - Must have: `EvaluateAsync(SecurityContext context, CancellationToken ct)` returning `Task<SecurityDecision>`
    - Must have: `StrategyId`, `DisplayName`, `SupportedDomains` properties
    - Must have: SecurityCapabilities or similar capability descriptor
    - Must have: XML documentation on all public members
    - If missing or stub: Implement following existing strategy interface patterns (see ICompressionStrategy, IEncryptionStrategy)

    **T95.A2 — SecurityDomain enum:**
    - Must include at minimum: AccessControl, DataProtection, Network, Identity, Compliance, ThreatDetection, IntegrityVerification, ZeroTrust
    - Must have XML documentation with `<summary>` tags per enum value
    - Research confirmed it exists at lines 14-51, but verify completeness

    **T95.A3 — SecurityContext class:**
    - Must include: UserId, ResourceId, Action, Timestamp, SourceIP, Claims/Attributes, AdditionalContext
    - Must be a class or record suitable for passing to EvaluateAsync
    - Must have XML documentation
    - Research marked this as "NEEDS VERIFICATION" — read the actual code

    **T95.A4 — SecurityDecision result types:**
    - Must include: Allowed (bool), Domain (SecurityDomain), Reason (string), PolicyId, Confidence, Timestamp
    - Research confirmed it exists at lines 57-80, but verify completeness
    - Must have XML documentation

    For each verified sub-task, mark it as [x] in TODO.md by finding the exact line.
    For each incomplete sub-task, implement the missing pieces following SDK patterns.
  </action>
  <verify>
    Grep `SecurityStrategy.cs` for `ISecurityStrategy` — must find interface definition.
    Grep `SecurityStrategy.cs` for `SecurityDomain` — must find enum with 8+ values.
    Grep `SecurityStrategy.cs` for `SecurityContext` — must find class/record definition.
    Grep `SecurityStrategy.cs` for `SecurityDecision` — must find class/record definition.
    `dotnet build DataWarehouse.SDK/DataWarehouse.SDK.csproj` compiles without errors.
  </verify>
  <done>
    T95.A1-A4 are verified production-ready: ISecurityStrategy interface has EvaluateAsync, SecurityDomain has 8+ domains, SecurityContext has all required fields, SecurityDecision includes Allowed/Domain/Reason/PolicyId. All marked [x] in TODO.md.
  </done>
</task>

<task type="auto">
  <name>Task 2: Verify T95.A5-A7 — ZeroTrust, Threat Detection, Integrity Verification</name>
  <files>
    DataWarehouse.SDK/Contracts/Security/SecurityStrategy.cs
    Metadata/TODO.md
  </files>
  <action>
    Continue reading `SecurityStrategy.cs` and verify the advanced security types:

    **T95.A5 — ZeroTrust policy framework:**
    - Must include: ZeroTrustPolicy (class/record with PolicyId, Rules, DefaultAction, etc.)
    - Must include: ZeroTrustEvaluation or similar result type
    - Must include: ZeroTrustPrinciple enum or similar (NeverTrustAlwaysVerify, LeastPrivilege, MicroSegmentation)
    - If interfaces/types reference "zero trust" in SecurityDomain enum but lack framework types: implement the framework
    - Pattern: Follow how other security sub-domains structure their types

    **T95.A6 — Threat detection abstractions:**
    - Must include: IThreatDetector interface (or IThreatDetectionStrategy) with DetectAsync method
    - Must include: ThreatIndicator record/class (Type, Severity, Confidence, Description)
    - Must include: ThreatSeverity enum (Critical, High, Medium, Low, Info)
    - Must include: ThreatType enum or similar categorization
    - Pattern: These feed into the UltimateAccessControl plugin's threat detection strategy

    **T95.A7 — Integrity verification framework:**
    - Must include: IIntegrityVerifier interface with VerifyAsync method
    - Must include: IntegrityResult record/class (IsValid, Hash, Algorithm, Violations)
    - Must include: IntegrityViolation record (Type, Description, AffectedResource)
    - Pattern: This connects to TamperProof pipeline's integrity checking

    For each sub-task:
    1. If types exist and are complete: Mark [x] in TODO.md
    2. If types exist but are incomplete (missing methods, missing XML docs): Complete them
    3. If types are missing entirely: Implement following existing SDK patterns
       - Use async/await with CancellationToken
       - Use C# records for immutable result types
       - Add complete XML documentation
       - Ensure no placeholder logic

    Search TODO.md for exact T95.A5, A6, A7 lines to update.
  </action>
  <verify>
    Grep `SecurityStrategy.cs` for ZeroTrust-related types — must find at least one class/record/interface.
    Grep `SecurityStrategy.cs` for "ThreatDetect" or "IThreatDetect" — must find interface or class.
    Grep `SecurityStrategy.cs` for "IntegrityVerif" or "IIntegrityVerif" — must find interface or class.
    `dotnet build DataWarehouse.SDK/DataWarehouse.SDK.csproj` compiles without errors.
    No NotImplementedException in SecurityStrategy.cs.
  </verify>
  <done>
    T95.A5-A7 are verified production-ready: ZeroTrust policy framework types exist with evaluation logic, threat detection abstractions include IThreatDetector with ThreatIndicator/ThreatSeverity, integrity verification has IIntegrityVerifier with IntegrityResult. All marked [x] in TODO.md.
  </done>
</task>

</tasks>

<verification>
1. `dotnet build DataWarehouse.SDK/DataWarehouse.SDK.csproj` succeeds
2. SecurityStrategy.cs contains all 7 type categories (A1-A7)
3. No NotImplementedException or placeholder logic in security types
4. All public members have XML documentation
5. SecurityDomain enum has at least 8 values
6. SecurityContext has UserId, ResourceId, Action at minimum
7. SecurityDecision has Allowed, Domain, Reason, PolicyId at minimum
8. ZeroTrust types include policy and evaluation constructs
9. Threat detection has interface + severity + indicator types
10. Integrity verification has verifier interface + result types
</verification>

<success_criteria>
- All T95.A1-A7 items verified as production-ready or implemented to be so
- SecurityStrategy.cs compiles cleanly as part of SDK build
- Zero placeholder/stub/simulation logic in security infrastructure
- TODO.md updated with [x] for each verified T95.A sub-task
</success_criteria>

<output>
After completion, create `.planning/phases/01-sdk-foundation-base-classes/01-02-SUMMARY.md`
</output>
