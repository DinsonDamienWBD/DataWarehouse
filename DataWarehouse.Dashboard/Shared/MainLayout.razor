@inherits LayoutComponentBase

<div class="d-flex" id="wrapper">
    <!-- Sidebar -->
    <div class="bg-dark text-white" id="sidebar-wrapper" style="min-width: 250px; max-width: 250px;">
        <div class="sidebar-heading p-3 border-bottom border-secondary">
            <i class="bi bi-database me-2"></i>
            <strong>DataWarehouse</strong>
        </div>
        <NavMenu />
    </div>

    <!-- Page Content -->
    <div id="page-content-wrapper" class="flex-grow-1">
        <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
            <div class="container-fluid">
                <span class="navbar-brand mb-0 h1">@_pageTitle</span>
                <div class="d-flex align-items-center">
                    <span class="badge bg-success me-3">
                        <i class="bi bi-circle-fill me-1" style="font-size: 0.5rem;"></i>
                        Connected
                    </span>
                    <span class="text-muted small">@DateTime.Now.ToString("yyyy-MM-dd HH:mm:ss")</span>
                </div>
            </div>
        </nav>

        <div class="container-fluid p-4">
            @Body
        </div>
    </div>
</div>

@code {
    private string _pageTitle = "Dashboard";

    protected override void OnParametersSet()
    {
        // Get the current route and set page title
        var uri = NavigationManager?.Uri;
        if (uri != null)
        {
            if (uri.Contains("/system-overview")) _pageTitle = "System Overview";
            else if (uri.Contains("/plugin-manager")) _pageTitle = "Plugin Manager";
            else if (uri.Contains("/query-explorer")) _pageTitle = "Query Explorer";
            else if (uri.Contains("/security-dashboard")) _pageTitle = "Security Dashboard";
            else if (uri.Contains("/cluster-status")) _pageTitle = "Cluster Status";
            else if (uri.Contains("/plugins")) _pageTitle = "Plugin Management";
            else if (uri.Contains("/storage")) _pageTitle = "Storage Management";
            else if (uri.Contains("/monitoring")) _pageTitle = "Monitoring";
            else if (uri.Contains("/configuration")) _pageTitle = "Configuration";
            else if (uri.Contains("/audit")) _pageTitle = "Audit Logs";
            else _pageTitle = "Dashboard";
        }
    }

    [Inject]
    private NavigationManager? NavigationManager { get; set; }
}

<style>
    #wrapper {
        min-height: 100vh;
    }

    #sidebar-wrapper {
        min-height: 100vh;
    }

    #sidebar-wrapper .sidebar-heading {
        font-size: 1.2rem;
    }

    #page-content-wrapper {
        min-width: calc(100vw - 250px);
        background-color: #f8f9fa;
    }
</style>
